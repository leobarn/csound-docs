<html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="generator" content="Adobe GoLive 4">		<title>_Recursive or infinite impulse response filters (IIR) are described by the formula</title>	</head>	<body bgcolor="white">		<h1>25. Designing Digital Butterworth and Chebyshev Filters</h1>		<h2>Themis Katsianos</h2>		<h3>Digital Filters: A General Overview</h3>		<p>Digital filters are used to modify, in any desirable way, the spectrum of a digital signal. We can think of them as &quot;black boxes&quot;, having a signal input, an in-the-box method used to process the signal, and a signal output. The ratio of the amplitude of the output wave to the amplitude of the input wave defines what is called the amplitude response of the filter, and can be measured using a sample sine wave. The four basic types of filters are: low-pass, high-pass, band-pass and band-reject, depending on how the in-the-box method affects the incoming signal. Low-pass filters will let all frequencies below a chosen cutoff frequency <img src="Image1.gif" width="13" height="10"> to pass through unaffected while attenuating all frequencies above it. High-pass filters on the contrary, will let all frequencies above a chosen cutoff frequency <img src="Image1.gif" width="13" height="10"> to pass through unaffected while attenuating all frequencies below it. Band-pass filters will let all frequencies within a selected band (characterized by an upper and lower limit as well as a center frequency) to pass through unaffected while attenuating all frequencies outside the band. Finally, band-reject filters will attenuate all frequencies within a selected bandwidth while letting through unaffected all frequencies outside the bandwidth.</p>		<p>The way the &quot;black box&quot; or digital filter operates is described by what is called its transfer function. In general, the transfer function will be of the form:</p>		<p><img src="Image2.gif" width="165" height="37"> (1)</p>		<p>Equation (1) is a representation of the function in the z-domain, which can be used to find what is called the zeros and poles of the transfer function. By zeros we mean any value that will make the numerator, and therefore the transfer function, zero, and by poles, any value that will zero the denominator and therefore make the transfer function infinite. Another way to describe it is to think that zeros and poles place valleys and peaks in the amplitude response of the filter. In the above formula, the <img src="Image3.gif" width="16" height="14"> terms are unit sample delay operators, <i>k</i> represents the order of the filter, and <img src="Image4.gif" width="24" height="13"> are a series of coefficients which determine the frequency response of the filter. The frequency response of a filter is a measurement of how the filter alters the characteristics of the incoming signal.</p>		<p>We can classify digital filters, according to the method used in the &quot;black box&quot;, as non-recursive and recursive filters. Non-recursive or finite impulse response filters (FIR) are described by the formula</p>		<p><img src="Image5.gif" width="78" height="29"> (2)</p>		<p>which means that the output signal y(n) is calculated based on previous inputs <img src="Image6.gif" width="34" height="13">. Recursive or infinite impulse response filters (IIR) are described by the formula</p>		<p><img src="Image7.gif" width="135" height="29"> (3)</p>		<p>As we can see, the current, nth sample output <img src="Image8.gif" width="21" height="13">, depends on current and previous inputs, as well as on previous outputs, hence must be computed recursively.</p>		<p>The problem then of designing a digital filter, for a given transfer function, is the calculation of the coefficients of either (1), (2), or (3). This paper will only consider recursive filters using the Butterworth and Chebyshev types of responses. We will show how the filter coefficients can be calculated for various orders and how this can be used to build digital recursive filters using Csound.</p>		<p>&nbsp;</p>		<h3>Calculation of Digital Recursive Filter Coefficients</h3>		<p>IIR filters can be designed using the bilinear transformation method. In simple words, the bilinear transformation method provides us the means of describing digital filter coefficients in terms of analog filters coefficients. The reason we want to do that is because there are well-known formulas for calculating analog filter coefficients, and these can be used to calculate the &quot;equivalent&quot; digital filter coefficients. If the analog transfer function describing the behavior of the filter is of the type</p>		<p><img src="Image9.gif" width="146" height="37"> (4)</p>		<p>then, we need a method that will allow us to relate the analog coefficients of equation (4) with the digital coefficients of equation (1) or (3). The relationship is</p>		<p><img src="Image10.gif" width="143" height="30"> (5)</p>		<p>where C is a constant. Let us see now how equation (5) can be used to derive digital filter coefficients in terms of analog ones. First, we choose the order of the filter we want to design. Let us for example consider the case of a 1st order filter. Then , equation (4) becomes</p>		<p><img src="Image11.gif" width="70" height="30"> (6)</p>		<p>Now, we substitute (5) to (6). We get</p>		<p><img src="Image12.gif" width="138" height="63"> (7)</p>		<p>If we compare (7) with the 1st order form of (1) we have the digital filter coefficients of a 1st order filter in terms of their analog counterparts. This method can be used for any desired order of filter we want to design. We now present the results for the orders through 1 to 5:</p>		<p>TABLE 1</p>		<p>		<table border="0" cellspacing="2" width="338">			<tr>				<td valign="top" colspan="3">Digital Filter Coefficients in terms of Analog Coefficients</td>			</tr>			<tr>				<td width="24%" valign="top">k=1, 1st order</td>				<td width="33%" valign="top">k=2, 2nd order</td>				<td width="43%" valign="top">k=3, 3rd order</td>			</tr>			<tr>				<td width="24%" valign="top"><img src="Image13.gif" width="66" height="61"></td>				<td width="33%" valign="top"><img src="Image14.gif" width="90" height="121"></td>				<td width="43%" valign="top"><img src="Image15.gif" width="130" height="175"></td>			</tr>		</table>		</p>		<p>&nbsp;</p>		<p>TABLE 2</p>		<p>		<table border="0" cellspacing="2" width="378">			<tr>				<td valign="top" colspan="2">Digital Filter Coefficients in terms of Analog Coefficients</td>			</tr>			<tr>				<td width="45%" valign="top">k=4, 4th order</td>				<td width="55%" valign="top">k=5, 5th order</td>			</tr>			<tr>				<td width="45%" valign="top"><img src="Image16.gif" width="146" height="207"></td>				<td width="55%" valign="top"><img src="Image17.gif" width="195" height="273"></td>			</tr>		</table>		</p>		<p>In order then to calculate the filter coefficients <img src="Image18.gif" width="24" height="13">, we need the values of <img src="Image19.gif" width="26" height="13"> and C.</p>		<p>&nbsp;</p>		<h3>The Butterworth Response</h3>		<p>Butterworth filters are defined by the property that the amplitude response is maximally flat in the passband. The Butterworth low-pass amplitude-squared function is defined by</p>		<p><img src="Image20.gif" width="90" height="31"> (8)</p>		<p>where f and <img src="Image21.gif" width="11" height="15"> represent frequency and cutoff frequency respectively and k is the order of the corresponding transfer function. Using the form of the Butterworth transfer function, (detailed formulas for which are given in the appendix), we can calculate the Butterworth analog coefficients <img src="Image22.gif" width="26" height="13">. We get:</p>		<p><img src="Image23.gif" width="36" height="13"> and <img src="Image24.gif" width="28" height="13">, for <img src="Image25.gif" width="20" height="10"> (9)</p>		<p>Also, the values of the coefficients <img src="Image26.gif" width="11" height="13">, for i ranging from 0 to 5 are listed in the following table:</p>		<p>TABLE 3</p>		<p>		<table border="0" cellspacing="2" width="442">			<tr>				<td valign="top" colspan="7">BUTTERWORTH DENOMINATOR COEFFICIENTS</td>			</tr>			<tr>				<td width="14%" valign="top">order</td>				<td width="14%" valign="top"><img src="Image27.gif" width="13" height="13"></td>				<td width="14%" valign="top"><img src="Image28.gif" width="13" height="13"></td>				<td width="14%" valign="top"><img src="Image29.gif" width="14" height="13"></td>				<td width="14%" valign="top"><img src="Image30.gif" width="14" height="13"></td>				<td width="14%" valign="top"><img src="Image31.gif" width="14" height="13"></td>				<td width="14%" valign="top"><img src="Image32.gif" width="14" height="13"></td>			</tr>			<tr>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="14%" valign="top">2</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">1.4142136</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="14%" valign="top">3</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">2</td>				<td width="14%" valign="top">2</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="14%" valign="top">4</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">2.6131259</td>				<td width="14%" valign="top">3.4142136</td>				<td width="14%" valign="top">2.6131259</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="14%" valign="top">5</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">3.2360680</td>				<td width="14%" valign="top">5.2360680</td>				<td width="14%" valign="top">5.2360680</td>				<td width="14%" valign="top">3.2360680</td>				<td width="14%" valign="top">1</td>			</tr>		</table>		</p>		<p>Finally, we give the formulas for the constant C:</p>		<p>TABLE 4</p>		<p>		<table border="0" cellspacing="2" width="442">			<tr>				<td valign="top" colspan="2">Constant C</td>			</tr>			<tr>				<td width="50%" valign="top">low-pass</td>				<td width="50%" valign="top"><img src="Image33.gif" width="61" height="15"></td>			</tr>			<tr>				<td width="50%" valign="top">high-pass</td>				<td width="50%" valign="top"><img src="Image34.gif" width="61" height="15"></td>			</tr>			<tr>				<td width="50%" valign="top">band-pass</td>				<td width="50%" valign="top"><img src="Image35.gif" width="70" height="15"></td>			</tr>			<tr>				<td width="50%" valign="top">band-reject</td>				<td width="50%" valign="top"><img src="Image36.gif" width="71" height="15"></td>			</tr>		</table>		</p>		<p>In Table 4, <img src="Image37.gif" width="12" height="12"> is the cutoff frequency, <img src="Image38.gif" width="11" height="12"> is the sampling rate frequency, and BW is the bandwidth. Let us now use all the above information to build digital Butterworth filters in Csound. Before we start , it is very important to note that the outputs will be calculated on every sample. In terms of Csound code, that means that it is necessary to have <b>sr = kr</b>, i.e. <b>ksmps = 1</b> because we want one sample to be calculated per control period. Since we want to use delayed samples, an ideal candidate for the job is Csound's signal modifier <b>delay1</b>, which delays the signal by 1 sample.</p>		<p>For all instruments use the header:</p>		<p>sr = 44100<br>		kr = 44100<br>		ksmps = 1<br>		nchnls = 1</p>		<p>All instruments use a test sound file as their input. A test score file for all the orchestras would be of the form:</p>		<p>;test score file<br>		;for high or low-pass filters use<br>		;instr # start duration cutoff frequency<br>		;for band-pass or band-reject use<br>		;instr # start duration center frequency bandwidth</p>		<p></p>		<h3>Butterworth 3rd Order Low-Pass</h3>		<p><img height="388" width="519" src="Butter3rd.gif"></p>		<p>Instrument 1 is a realization of a Butterworth 3rd order low-pass filter. The order of the filter is 3; equation (3) gives:</p>		<p><img src="Image39.gif" width="291" height="13"></p>		<p>The orchestra follows:</p>		<p>instr 1<br>		idur = p3 ;duration of the sound file<br>		icut = p4 ;cutoff frequency<br>		iscale = p5 ;scaling factor<br>		;Calculate the intermediate coefficient C using Table 4<br>		ivar = cos(3.14159*icut/sr)/sin(3.14159*icut/sr)<br>		;Calculate the filter coefficients using the data from Tables 1,3<br>		ivarsqrd ipow ivar,2 ;ivar squared<br>		ivarcbd ipow ivar,3 ;ivar cubed<br>		ia0 = 1/(1+2*ivar+2*ivarsqrd+ivarcbd)<br>		ia1 = 3*ia0<br>		ia2 = 3*ia0<br>		ia3 = ia0<br>		ib1 = (3+2*ivar-2*ivarsqrd-3*ivarcbd)*ia0<br>		ib2 = (3-2*ivar-2*ivarsqrd+3*ivarcbd)*ia0<br>		ib3 = (1-2*ivar+2*ivarsqrd-ivarcbd)*ia0</p>		<p>;Do the appropriate initializations<br>		aout1 init 0<br>		aout2 init 0<br>		aout3 init 0<br>		ainput soundin &quot;test_sound&quot; ;the input signal<br>		;Create a 3rd order delay<br>		adel1 delay1 ainput<br>		adel2 delay1 adel1<br>		adel3 delay1 adel2<br>		;Calculate the output signal<br>		aout = ia0*ainput+ia1*adel1+ia2*adel2+ia3*adel3-ib1*aout1-ib2*aout2- ib3*aout3<br>		;Apply recursion formula : y(n-1) = y(n), y(n-2) = y(n-1), etc.<br>		aout3 = aout2<br>		aout2 = aout1<br>		aout1 = aout<br>		;provide a simple exponential segment envelope to the signal before ;output<br>		aenv expseg 0.1,.1*idur,1,idur*.8,1,idur*.1,.1<br>		out aout*aenv*iscale ;output the signal<br>		endin</p>		<p>Let us now build a high-pass Butterworth filter in Csound. The only difference is that we have to make the following substitution in equation (4):</p>		<p>p --&gt; -p (10)</p>		<p>which will result in the changing of the sign (from + to -) of the odd coefficients. What that means is that we can calculate the filter coefficients using Tables 1,2 and then change the sign of the odd numbered coefficients, i.e.</p>		<p><img src="Image40.gif" width="168" height="13"> (11)</p>		<p>We will do that building a 5th order high-pass Butterworth filter.</p>		<p>&nbsp;</p>		<h3>Butterworth 5th Order High-Pass</h3>		<h3><img height="538" width="484" src="Butter5th.GIF"></h3>		<p>Instrument 2 is a realization of a Butterworth 5th order high-pass filter. The order of the filter is 5; equation (3) gives:</p>		<p><img src="Image41.gif" width="284" height="29"></p>		<p>&nbsp;</p>		<p>The orchestra follows:</p>		<p>&nbsp;</p>		<p>instr 2<br>		idur = p3 ;duration of the sound file<br>		icut = p4 ;cutoff frequency<br>		iscale = p5 ;scaling factor<br>		;Calculate the intermediate coefficient C from Table 4<br>		iv = sin(3.14159*icut/sr)/cos(3.14159*icut/sr)<br>		;Calculate the filter coefficients using the data from Tables 2, 3<br>		iv2 ipow iv,2 ;iv squared<br>		iv3 ipow iv,3 ;iv cubed<br>		iv4 ipow iv,4 ;iv to the fourth<br>		iv5 ipow iv,5 ;iv to the fifth<br>		ia0 = 1/(1+3.2360680*iv+5.2360680*iv2+5.2360680*iv3+3.2360680*iv4+ iv5)<br>		ia1 = -5*ia0<br>		ia2 = 10*ia0<br>		ia3 = -10*ia0<br>		ia4 = 5*ia0<br>		ia5 = -ia0<br>		ib1 = -(5+3*3.2360680*iv+5.2360680*iv2-5.2360680*iv3- 3*3.2360680*iv4-5*iv5)*ia0<br>		ib2 = (10+2*3.2360680*iv-2*5.2360680*iv2-2*5.2360680*iv3+ 2*3.2360680*iv4+10*iv5)*ia0<br>		ib3 = -(10-2*3.2360680*iv-2*5.2360680*iv2+2*5.2360680*iv3+ 2*3.2360680*iv4-10*iv5)*ia0<br>		ib4 = (5-3*3.2360680*iv+5.2360680*iv2+5.2360680*iv3- 3*3.2360680*iv4+5*iv5)*ia0<br>		ib5 = -(1-3.2360680*iv+5.2360680*iv2-5.2360680*iv3+3.2360680*iv4- iv5)*ia0<br>		;Do the appropriate initializations<br>		aout1 init 0<br>		aout2 init 0<br>		aout3 init 0<br>		aout4 init 0<br>		aout5 init 0<br>		ainput soundin &quot;test_sound&quot; ;the input signal<br>		;Create a 5th order delay<br>		adel1 delay1 ainput<br>		adel2 delay1 adel1<br>		adel3 delay1 adel2<br>		adel4 delay1 adel3<br>		adel5 delay1 adel4<br>		;Calculate the output signal<br>		aout = ia0*ainput+ia1*adel1+ia2*adel2+ia3*adel3+ia4*adel4+<br>		ia5*adel5-ib1*aout1-ib2*aout2-ib3*aout3-ib4*aout4-ib5*aout5<br>		;Apply recursion formula :<br>		aout5 = aout4<br>		aout4 = aout3<br>		aout3 = aout2<br>		aout2 = aout1<br>		aout1 = aout<br>		;provide a simple exponential segment envelope to the signal before ;output<br>		aenv expseg 0.1,.1*idur,1,idur*.8,1,idur*.1,.1<br>		out aout*aenv*iscale ;output the signal<br>		endin</p>		<p>&nbsp;</p>		<p>These techniques for building recursive filters can be applied to any order of Butterworth filter desired, both high and low-pass. We will now study the case of band-pass and band-reject filters. In order to extend our vocabulary we introduce the Chebyshev approximation. We will build digital Chebyshev band-pass and band-reject filters but the technique is the same and can be used to build digital Butterworth band-pass and band-reject filters. Furthermore, the techniques and sets of equations described above for building digital Butterworth low and high-pass filters can be used to build digital Chebyshev low and high-pass filters respectively, of any order desired.</p>		<p>&nbsp;</p>		<h3><b>The Chebyshev Response</b></h3>		<p>The basic Chebyshev amplitude response is defined as</p>		<p><img src="Image42.gif" width="115" height="32"> (12)</p>		<p>where k now is both the order of the transfer function and the order of the corresponding Chebyshev polynomial, <img src="Image43.gif" width="13" height="14"> is a parameter which provides the proper passband ripple, and <i>a</i> is a constant which determines the proper dc gain level. As opposed to the Butterworth approximation, the passband is constrained to oscillate between constant bounds (determined by the chosen ripple). Using the form of the Chebyshev transfer function, (detailed formulas are given in the appendix), we can calculate the Chebyshev analog coefficients <img src="Image44.gif" width="26" height="13">. Equation (9) takes care of the coefficients <img src="Image45.gif" width="12" height="13">. We now give the low-pass filter denominator coefficients or <img src="Image46.gif" width="11" height="13"> for Chebyshev 1 dB ripple up to 5th order:</p>		<p>TABLE 5</p>		<p>		<table border="0" cellspacing="2" width="442">			<tr>				<td valign="top" colspan="7">CHEBYSHEV 1 dB RIPPLE (<img src="Image47.gif" width="79" height="14">)</td>			</tr>			<tr>				<td width="14%" valign="top">order</td>				<td width="14%" valign="top"><img src="Image27.gif" width="13" height="13"></td>				<td width="14%" valign="top"><img src="Image28.gif" width="13" height="13"></td>				<td width="14%" valign="top"><img src="Image29.gif" width="14" height="13"></td>				<td width="14%" valign="top"><img src="Image30.gif" width="14" height="13"></td>				<td width="14%" valign="top"><img src="Image31.gif" width="14" height="13"></td>				<td width="14%" valign="top"><img src="Image32.gif" width="14" height="13"></td>			</tr>			<tr>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">1.9652267</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="14%" valign="top">2</td>				<td width="14%" valign="top">1.1025103</td>				<td width="14%" valign="top">1.0977343</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="14%" valign="top">3</td>				<td width="14%" valign="top">0.4913067</td>				<td width="14%" valign="top">1.2384092</td>				<td width="14%" valign="top">0.9883412</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">&nbsp;</td>				<td width="14%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="14%" valign="top">4</td>				<td width="14%" valign="top">0.2756276</td>				<td width="14%" valign="top">0.7426194</td>				<td width="14%" valign="top">1.4539248</td>				<td width="14%" valign="top">0.9528114</td>				<td width="14%" valign="top">1</td>				<td width="14%" valign="top">&nbsp;</td>			</tr>			<tr>				<td width="14%" valign="top">5</td>				<td width="14%" valign="top">0.1228267</td>				<td width="14%" valign="top">0.5805342</td>				<td width="14%" valign="top">0.9743961</td>				<td width="14%" valign="top">1.6888160</td>				<td width="14%" valign="top">0.9368201</td>				<td width="14%" valign="top">1</td>			</tr>		</table>		</p>		<p>Table 5 can be used for building Chebyshev 1 dB ripple low and high-pass filters in the same way as we described for Butterworth filters. In order to use it for band-pass and band-reject Chebyshev filters we present it in a partially factored form, which is another way to write the denominator of equation (4) using the values for the Chebyshev coefficients:</p>		<p>TABLE 6</p>		<p>		<table border="0" cellspacing="2" width="450">			<tr>				<td width="14%" valign="top">order</td>				<td width="86%" valign="top">CHEBYSHEV 1 dB RIPPLE</td>			</tr>			<tr>				<td width="14%" valign="top">1</td>				<td width="86%" valign="top">(1.965267 + s)</td>			</tr>			<tr>				<td width="14%" valign="top">2</td>				<td width="86%" valign="top">(1.1025104 + 1.0977344s + <img src="Image48.gif" width="10" height="14">)</td>			</tr>			<tr>				<td width="14%" valign="top">3</td>				<td width="86%" valign="top">(0.4941706 + s) (0.9942046 + 0.4941706s + <img src="Image49.gif" width="12" height="14">)</td>			</tr>			<tr>				<td width="14%" valign="top">4</td>				<td width="86%" valign="top">(0.9286753 + 0.2097744s + <img src="Image49.gif" width="10" height="14">) (0.2215684 + 0.5064404s + <img src="Image49.gif" width="10" height="14">)</td>			</tr>			<tr>				<td width="14%" valign="top">5</td>				<td width="86%" valign="top">(0.2894933 + s) (0.9883149 + 0.1789168s + <img src="Image49.gif" width="10" height="14">) (0.4292978 + 0.46841s +<img src="Image49.gif" width="10" height="14">)</td>			</tr>		</table>		</p>		<p>In order to get from low-pass to band-pass the following transformation has to be made:</p>		<p><img src="Image50.gif" width="91" height="33"> (13)</p>		<p>where C is taken from Table 4 and D is given:</p>		<p><img src="Image51.gif" width="72" height="17"> (14)</p>		<p>In other words, we have to substitute (13) in one of the expressions of Table 6, depending on the order of the filter we want to build. Remember that the order of <i>z </i>represents the order of the digital filter. Examining equation (13), we see that a first order of <i>s </i>will result in a 2nd order digital filter, a 2nd order of <i>s </i>will result in a 4th order digital filter, and so on.</p>		<p>As an example, let us build a 2nd order Chebyshev band-pass filter. As we said, we have to substitute (13) to the 1st order form of Table 6. By doing so we get</p>		<p><img src="Image52.gif" width="227" height="47"> (15)</p>		<p>Comparing (15) and (1) we get:</p>		<p><img src="Image53.gif" width="74" height="109"> (16)</p>		<p>Let us now use the above information to build a 2nd order Chebyshev band-pass filter in Csound.</p>		<p>&nbsp;</p>		<h3><b>Chebyshev 2nd order band-pass</b></h3>		<h3><b><img height="331" width="487" src="Cheby2ndPass.gif"></b></h3>		<p>Instrument 3 is a realization of a Chebyshev 2nd order band-pass filter. Since the order of the filter is 2, equation (3) gives:</p>		<p><img src="Image54.gif" width="210" height="13"></p>		<p>&nbsp;</p>		<p>&nbsp;</p>		<p>The orchestra follows:</p>		<p>instr 3<br>		idur = p3 ;duration of the sound file<br>		icenter = p4 ;center frequency<br>		ibandwth = p5 ;bandwidth<br>		iscaling = p6 ;scaling factor<br>		;Calculate the intermediate coefficient C using Table 4<br>		ivar = cos(3.14159*ibandwth/sr)/sin(3.14159*ibandwth/sr)<br>		;Calculate the scaling factor D using eq. (14)<br>		iscale = 2*cos(6.28318*icenter/sr)<br>		;Calculate the filter coefficients using the set of equations (16)<br>		ia0 = 1.965267/(1.965267+ivar)<br>		ia1 = 0<br>		ia2 = -ia0<br>		ib1 = -ivar*iscale/(1.965267+ivar)<br>		ib2 = (ivar-1.965267)/(1.965267+ivar)<br>		;Do the appropriate initializations<br>		aout1 init 0<br>		aout2 init 0<br>		ainput soundin &quot;test_sound&quot; ;the input signal<br>		;Create a 2nd order delay<br>		adel1 delay1 ainput<br>		adel2 delay1 adel1<br>		;Calculate the output signal<br>		aout = ia0*ainput+ia1*adel1+ia2*adel2-ib1*aout1-ib2*aout2<br>		;Apply recursion formula : y(n-1) = y(n), y(n-2) = y(n-1), etc.<br>		aout2 = aout1<br>		aout1 = aout<br>		;provide a simple exponential segment envelope to the signal before ;output<br>		aenv expseg 0.1,.1*idur,1,idur*.8,1,idur*.1,.1<br>		out aout*aenv*iscaling ;output the signal<br>		endin</p>		<p>In order to get from low-pass to band-reject, the following transformation has to be made:</p>		<p><img src="Image55.gif" width="75" height="30"> (17)</p>		<p>where, again, C is taken from Table 4 and D from equation (14). Let us for example build a 2nd order Chebyshev 1 dB band-reject filter. Again, because of the form of (17) we have to use the 1st order partially factored form of Table 6. Substitution of (17) to the 1st order partially factored form of Table 6 gives:</p>		<p><img src="Image56.gif" width="72" height="23"><img src="Image57.gif" width="201" height="47"> (18)</p>		<p>Comparing (18) and (1) we get:</p>		<p><img src="Image58.gif" width="75" height="119"> (19)</p>		<p>Let us now use the set of equations (19) to build a 2nd order Chebyshev 1 dB band-reject filter in Csound.</p>		<p>&nbsp;</p>		<h3><b>Chebyshev 2nd Order Band-Reject</b></h3>		<h3><b><img height="331" width="487" src="Cheby2ndReject.gif"></b></h3>		<p>Instrument 4 is a realization of a Chebyshev 2nd order band-reject filter. Since the order of the filter is 2, equation (3) gives:</p>		<p><img src="Image59.gif" width="210" height="13"></p>		<p>The orchestra follows:</p>		<p>instr 4<br>		idur = p3 ;duration of the sound file<br>		icenter = p4 ;center frequency<br>		ibandwth = p5 ;bandwidth<br>		iscaling = p6 ;scaling factor<br>		;Calculate the intermediate coefficient C using Table 4<br>		ivar = sin(3.14159*ibandwth/sr)/cos(3.14159*ibandwth/sr)<br>		;Calculate the scaling factor D using eq. (14)<br>		iscale = 2*cos(6.28318*icenter/sr)<br>		;Calculate the filter coefficients using the set of equations (19)<br>		ia0 = 1.965267/(1.965267+ivar)<br>		ia1 = -1.965267*iscale/(1.965267+ivar)<br>		ia2 = ia0<br>		ib1 = -ivar*iscale/(1.965267+ivar)<br>		ib2 = (1.965267-ivar)/(1.965267+ivar)<br>		;Do the appropriate initializations<br>		aout1 init 0<br>		aout2 init 0<br>		ainput soundin &quot;test_sound&quot; ;the input signal<br>		;Create a 2nd order delay<br>		adel1 delay1 ainput<br>		adel2 delay1 adel1<br>		;Calculate the output signal<br>		aout = ia0*ainput+ia1*adel1+ia2*adel2-ib1*aout1-ib2*aout2<br>		;Apply recursion formula : y(n-1) = y(n), y(n-2) = y(n-1), etc.<br>		aout2 = aout1<br>		aout1 = aout<br>		;provide a simple exponential segment envelope to the signal before ;output<br>		aenv expseg 0.1,.1*idur,1,idur*.8,1,idur*.1,.1<br>		out aout*aenv*iscaling ;output the signal<br>		endin</p>		<h3>Conclusion</h3>		<p>We have presented a step by step method for designing digital Butterworth and Chebyshev filters in Csound. The reader/user can choose the kind and order of the filter he/she wants to build, depending on the effect desired. It should be kept in mind, that computation time and sharpness of the filter response increases as the order of the transfer function increases, so the choice of the order should be made according to the specific need of the application.&nbsp;</p>		<h3>Appendix</h3>		<h3>The Butterworth Transfer Function</h3>		<p>The complete analog transfer function of the Butterworth response is given by:</p>		<p><b><img src="Image60.gif" width="137" height="55"></b> <img src="Image61.gif" width="85" height="11">, if <i>n</i> even (A.1)</p>		<p>&nbsp;</p>		<p><b><img src="Image62.gif" width="165" height="55"></b> <img src="Image63.gif" width="85" height="11">, if <i>n</i> odd (A.2)</p>		<p>&nbsp;</p>		<p>In the above formulas we have:</p>		<p><b><img src="Image64.gif" width="147" height="31"></b> (A.3)</p>		<p>with</p>		<p><b><img src="Image65.gif" width="226" height="84"></b> (A.4)</p>		<p>In the above formulas, <i>n </i>is the desired order. In order then to get the coefficients of (9) and TABLE 3, we have to use (A.1)-(A.4) and compare the results with (4).</p>		<p>&nbsp;</p>		<h3>The Chebyshev Transfer Function</h3>		<p>The complete analog Chebyshev transfer function is given by:</p>		<p><b><img src="Image66.gif" width="135" height="57"></b> <img src="Image63.gif" width="85" height="11">, if <i>n</i> even (A.5)</p>		<p><b><img src="Image67.gif" width="189" height="69"></b> (A.6)</p>		<p>In the above formulas we have:</p>		<p><b><img src="Image68.gif" width="210" height="31"></b> (A.7)</p>		<p>with</p>		<p><b><img src="Image69.gif" width="252" height="87"></b> (A.8)</p>		<p>In the above formulas, <i>n </i>is the desired order. In order then to get the coefficients of (9) and TABLE 5, we have to use (A.5)-(A.8) and compare the results with (4).</p>		<h3>FURTHER READING</h3>		<p>1. Dodge, Charles &amp; T. A. Jerse. &quot;Computer Music. Synthesis, Composition, and Performance.&quot; New York: Schirmer Books, A Division of Macmillan, Inc., 1985.</p>		<p>2. Moore, Richard F. &quot;Elements of Computer Music.&quot; New Jersey: Prentice Hall, A Division of Simon &amp; Schuster, 1990.</p>		<p>3. Oppenheim, Alan V. and Ronald W. Schafer. &quot;Digital Signal Processing.&quot; New Jersey: Prentice-Hall, Inc., 1975.</p>		<p>4. Stanley, William D. and Gary R. Dougherty and Ray R. Dougherty. &quot;Digital Signal Processing.&quot; 2nd edition. Reston, Virginia: Reston Publishing Company, Inc., A Prentice Hall Company, 1984.</p>		<p>5. Strawn, John, edited by. &quot;Digital Audio Signal Processing. An Anthology.&quot; Los Altos, California: William Kaufman, Inc., 1985.</p>		<p>6. Thede, Les. &quot;Analog and Digital Filter Design using C.&quot; Prentice Hall PTR, Upper Sadle River, New Jersey, 1996.</p>		<p>7. Vercoe Barry. &quot;Csound. A Manual for the Audio Processing System and Supporting Programs with Tutorials.&quot; Media Lab, M.I.T., 1993.</p>		<p>8. Weinberg, Louis. &quot;Network Analysis and Synthesis.&quot; McGraw-Hill Book Company, Inc., 1962.	</body></html>