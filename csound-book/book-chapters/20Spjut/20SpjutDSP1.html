<html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<title>What Happens When You Run A Csound Program</title>		<meta name="generator" content="Adobe GoLive 4">	</head>	<body bgcolor="white">		<h1><b>An Introduction to Signal Processing with Csound</b></h1>		<h2><b>R. Erik Spjut</b></h2>		<div align="justify">			<p>Signal Processing has become a vital part of a modern engineer&#146;s vocabulary. From earthquake retrofitting to direct-from-satellite TV broadcasts to chemical-process control, a knowledge of signal processing and dynamic systems has become essential to an engineer&#146;s education. However, learning signal processing is often a dull exercise in performing integrations, summations and complex arithmetic. Csound has a number of features that make it valuable as an adjunct to the traditional course work. First, it was designed from the ground up to follow the principles of digital signal processing, although this fact is probably hidden from the casual user. Second, hearing a swept filter or an aliased sine wave brings the signal processing concepts home in an immediate and visceral way.</p>		</div>		<div align="justify">			<p>This chapter is an attempt to introduce the student of signal processing to the powerful examples available in Csound. It is also an attempt to introduce the concepts of signal processing to the Csound practitioner in the hopes that you will better understand why Csound does what it does and also be better able to make Csound do what you want.</p>		</div>		<div align="justify">			<p>Because all of the topics are interrelated, occasional use or mention is made of later topics in the derivation of earlier topics. I have tried to keep the order of presentation such that these forward references are minimized.</p>		</div>		<div align="justify">			<p>Even though Csound is very powerful, it will not do every sort of calculation that you might desire. Often you need to do some sort of symbolic or numeric calculation to figure out what values to use in Csound. These sorts of calculations are best done using a program like <i>Mathematica</i>, <i>Maple</i>, <i>MathCAD</i>, or <i>Matlab</i>. I have given some examples of these sorts of calculations using <i>Mathematica</i> to assist the interested reader. Just as you do not really need to know how to do long divisions in order to use a calculator, you do not really need to know calculus to use <i>Mathematica</i> to integrate.</p>		</div>		<p><b>Mathematical Conventions</b></p>		<p><b>Variables</b></p>		<div align="justify">			<p>A <i>variable</i> is a symbol for a quantity or thing that can change or vary. Common variables in algebra are <img src="Image1.gif" width="8" height="8"> and <img src="Image2.gif" width="8" height="10">. Some of the variables used in this chapter are <i>t</i> (usually stands for time), <i>T</i> (a time interval or period), <i>f</i> (frequency of a continuous signal) and <i>F</i> (frequency of a discrete signal).</p>		</div>		<p><b>Functions</b></p>		<div align="justify">			<p>A <i>function</i> is the way one variable depends on (or relates to) another variable, <i>e.g.</i> in the equation:</p>		</div>		<p><img src="Image3.gif" width="44" height="12">(20.1)</p>		<div align="justify">			<p>The variable <i>y</i> is a function of the variable <i>x</i>. The function says &#145;take whatever value <i>x</i> presently has, multiply it by three and add five to that result.&#146; That final result is the present value of <i>y</i>. Often, when one variable such as <i>y</i> is a function of another variable, such as <i>t</i> or <i>n</i>, but we do not know (or care) exactly what the function is, we write <img src="Image4.gif" width="18" height="15"> or <img src="Image5.gif" width="20" height="14">. In spoken language we would read <img src="Image6.gif" width="18" height="15"> as <i>y-of-t</i> and <img src="Image7.gif" width="20" height="14"> as <i>y-of-n</i>. Three of the most common functions in signal processing are the <i>sine</i> of <i>x</i> (written as <img src="Image8.gif" width="23" height="10">), the <i>cosine</i> of <i>x</i> (written as <img src="Image9.gif" width="24" height="8">) and the <i>exponential</i> of <i>x</i> (written as <img src="Image10.gif" width="11" height="13"> or <img src="Image11.gif" width="26" height="10">). A function where <img src="Image12.gif" width="50" height="15"> (like <img src="Image13.gif" width="36" height="16">) is called an <i>even</i> function. A function where <img src="Image14.gif" width="56" height="15"> (like <img src="Image15.gif" width="32" height="15">) is called an <i>odd</i> function. Many functions are neither even nor odd.</p>		</div>		<p><b>Independent and Dependent Variables</b></p>		<div align="justify">			<p>If a variable is not a function of another variable it is called an <i>independent variable</i>, because it can vary in any way it pleases. If a variable <i>is</i> a function of another variable, it is called a <i>dependent variable</i>, because its value depends on the value of some other variable. In signal processing, in addition to being either independent or dependent, our variables are often <i>complex</i>.</p>		</div>		<p><b>Complex Numbers</b></p>		<div align="justify">			<p>A <i>complex number</i> is a mathematical shorthand for combining two independent numbers into one symbol. If the two independent numbers in our complex number are <i>a</i> and <i>b</i>, mathematicians would write the complex number as <img src="Image16.gif" width="24" height="11"> and engineers would write it as <img src="Image17.gif" width="25" height="13">. For historical reasons, <i>a</i> is called the real part and <i>b</i> is called the imaginary part and <i>i</i> or <i>j</i> is called the <i>imaginary unit</i>. It is defined by <img src="Image18.gif" width="33" height="15">. Engineers use <img src="Image19.gif" width="7" height="13"> as the imaginary unit instead of <img src="Image20.gif" width="6" height="11">, because <img src="Image20.gif" width="6" height="11"> is reserved for current. <i>Mathematica</i> uses 'I' for the imaginary unit.</p>		</div>		<p><b>Complex Addition and Subtraction</b></p>		<div align="justify">			<p>If we have two complex numbers <img src="Image21.gif" width="26" height="13"> and <img src="Image22.gif" width="28" height="14">, we can define the relationships for addition as the sum of the real parts and the sum of the imaginary parts:</p>		</div>		<p><img src="Image23.gif" width="146" height="15">(20.2)</p>		<div align="justify">			<p>and subtraction as the difference of the real parts and the difference of the imaginary parts:</p>		</div>		<p><img src="Image24.gif" width="146" height="15">(20.3)</p>		<p><b>Polar Form</b></p>		<div align="justify">			<p>If we think of a complex number as a point on a Cartesian coordinate system (a rectangular graph) we can define the distance from the origin to the complex number as the <i>magnitude</i> or absolute value of the complex number:</p>		</div>		<p><img src="Image25.gif" width="76" height="18">(20.4)</p>		<p><img src="Image26.gif" width="178" height="182"></p>		<p><b>Figure 20.1</b> A complex number in both Cartesian and Polar form.</p>		<div align="justify">			<p>We can think of the angle between the positive <i>x</i>-axis and the line segment from the origin to the complex number as the <i>angle</i> (also known as the <i>phase angle</i>, or the <i>phase</i> or the <i>argument</i>) of the complex number:</p>		</div>		<p><img src="Image27.gif" width="79" height="24">(20.5)</p>		<div align="justify">			<p>The function <i>arctan</i> is the arctangent. It means the-angle-whose-tangent-is).</p>		</div>		<div align="justify">			<p>A complex number expressed as a magnitude and an angle is said to be in polar form. For signal processing it is usually most convenient to write the magnitude as <i>r</i> and the angle as <img src="Image28.gif" width="8" height="10">, so that our complex number becomes<img src="Image29.gif" width="18" height="13">, where <img src="Image30.gif" width="51" height="13">and <img src="Image31.gif" width="48" height="13">.</p>		</div>		<p><b>Complex Multiplication and Division</b></p>		<div align="justify">			<p>With two complex numbers, <img src="Image32.gif" width="23" height="15"> and <img src="Image33.gif" width="24" height="15">, in polar form, we can define multiplication as the product of the magnitudes and the sum of the angles:</p>		</div>		<p><img src="Image34.gif" width="133" height="20">(20.6)</p>		<div align="justify">			<p>We can define division as the ratio of the magnitudes and the difference of the angles:</p>		</div>		<p><img src="Image35.gif" width="88" height="31">(20.7)</p>		<div align="justify">			<p>There are formulas for multiplication and division using <i>a</i> and <i>b</i> instead of <i>r</i> and <img src="Image36.gif" width="8" height="10">, but they usually make calculations much harder.</p>		</div>		<p><b>Complex Variables</b></p>		<div align="justify">			<p>By analogy with complex numbers, the <i>complex variable</i> <i>z</i> contains two normal (real) variables <i>x</i> and <i>y</i>:</p>		</div>		<p><img src="Image37.gif" width="43" height="13">(20.8)</p>		<div align="justify">			<p>Again we call <i>x</i> the real part and <i>y</i> the imaginary part. We can (and usually do) express complex variables in polar form:</p>		</div>		<p><img src="Image38.gif" width="34" height="13">(20.9)</p>		<div align="justify">			<p>Where <img src="Image39.gif" width="55" height="17">and <img src="Image40.gif" width="63" height="13">, but <i>r</i> and <img src="Image36.gif" width="8" height="10"> are now variables instead of numbers.</p>		</div>		<p><b>Complex Functions</b></p>		<div align="justify">			<p>A <i>complex function</i> or a function of a complex variable is made up of two normal functions, again a real part and an imaginary part. As an example, let us look at the function <img src="Image41.gif" width="11" height="13">, since it is used so frequently in signal processing (we got ahead of ourselves and already used part of it in our definition of polar form).</p>		</div>		<p><img src="Image42.gif" width="245" height="16">,(20.10)</p>		<div align="justify">			<p>So the real part of <img src="Image41.gif" width="11" height="13"> is the product of the exponential of <i>x</i> and the cosine of <i>y</i>, <img src="Image43.gif" width="35" height="15"> and the imaginary part is the product of the exponential of <i>x</i> and the sine of <i>y,</i> <img src="Image44.gif" width="34" height="15">. In terms of polar form the magnitude of <img src="Image41.gif" width="11" height="13"> is <img src="Image45.gif" width="11" height="13"> and the angle is <i>y</i>.</p>		</div>		<div align="justify">			<p>It may be worth noting that <i>Mathematica</i> treats almost all variables and functions as being complex. For example, <i>Mathematica</i> will evaluate Exp[I Pi/2] or Exp[3 + 2 I] as readily as Sin[Pi/2].</p>		</div>		<p><b>Summation</b></p>		<div align="justify">			<p>The symbol:</p>		</div>		<p><img src="Image46.gif" width="32" height="31">(20.11)</p>		<div align="justify">			<p>is a summation symbol. It means to take the <i>index variable</i> (the variable on the bottom, usually <i>n</i>), let it take on all integer values from the starting index (the number on the bottom) to the ending index (the number on the top), substitute the integer into the main expression and add up the values of all of the substitutions.</p>		</div>		<div align="justify">			<p>For example,</p>		</div>		<p><img src="Image47.gif" width="247" height="31">(20.12)</p>		<p><b>Integration and Differentiation</b></p>		<div align="justify">			<p>The symbol:</p>		</div>		<p><img src="Image48.gif" width="14" height="19">(20.13)</p>		<div align="justify">			<p>is the integration symbol. Mathematicians usually define an integral in terms of limits and infinitesimal. It is usually adequate to think of an integral as the area between a real function and the <i>x</i>-axis. A large part of a calculus class is devoted to learning how to evaluate integrals of functions.</p>		</div>		<div align="justify">			<p><i>Mathematica</i> will integrate a large number of functions symbolically (meaning the result is a function) and almost any function numerically (meaning the result is a number). For example, the integral of the sine of <i>x</i>, which is written:</p>		</div>		<p><img src="Image49.gif" width="29" height="19">(20.14)</p>		<div align="justify">			<p>is evaluated symbolically in <i>Mathematica</i> as <i>Integrate[Sin[x],x]</i> and the integral of the cosine of <i>x</i> from 0 to <i>p</i>, which is written:</p>		</div>		<p><img src="Image50.gif" width="30" height="33">(20.15)</p>		<div align="justify">			<p>is evaluated numerically in <i>Mathematica</i> as <i>Integrate[Cos[x],{x,0,Pi}].</i></p>		</div>		<div align="justify">			<p>The symbol:</p>		</div>		<p><img src="Image51.gif" width="15" height="24">(20.16)</p>		<div align="justify">			<p>is the derivative of the function <i>y</i> with respect to the variable <i>x</i>. Mathematicians again define derivatives in terms of limits and infinitesimal. It is usually adequate to think of a derivative as the slope of a function. A small part of a calculus class is devoted to learning how to take derivatives of functions.</p>		</div>		<div align="justify">			<p><i>Mathematica</i> will evaluate the derivative of almost any function. For example, the derivative of the cosine of <i>x</i> with respect to <i>x</i>, which is written:</p>		</div>		<p><img src="Image52.gif" width="32" height="24">(20.17)</p>		<div align="justify">			<p>is evaluated in <i>Mathematica</i> by <i>D[Cos[x],x].</i></p>		</div>		<p><b>Signals</b></p>		<div align="justify">			<p>A <i>signal</i> is a function of one or more independent variables. The purpose or use of a signal is to convey information. Examples of common signals are the voltage coming out of an audio amplifier, the Dow-Jones industrial average, the outside temperature, and the display on a computer screen, the output from a radio transmitter. Csound is structured for processing signals of a single independent variable, so we will restrict ourselves to signals that are a function of only one independent variable, either time or sample number.</p>		</div>		<p><b>Continuous Signals</b></p>		<p><img src="Image53.gif" width="332" height="143"></p>		<p><b>Figure 20.2</b> A continuous-time signal.</p>		<div align="justify">			<p>Signals are divided into two classes, <i>continuous-time</i> and <i>discrete-time</i>. Continuous-time signals have a value at any instant of time. Most physical phenomena, such as the temperature, sound, or a person&#146;s weight are continuous-time signals. Two continuous-time signals that are very important in signal processing are <img src="Image54.gif" width="42" height="15"> and <img src="Image55.gif" width="43" height="15">. Engineers often use the Euler formula as a shorthand notation for representing these two signals at the same time:</p>		</div>		<p><img src="Image56.gif" width="132" height="16">(20.18)</p>		<div align="justify">			<p>where <img src="Image57.gif" width="35" height="15">. One can get back to sines and cosines with:</p>		</div>		<p><img src="Image58.gif" width="114" height="26">(20.19)</p>		<div align="justify">			<p>and:</p>		</div>		<p><img src="Image59.gif" width="113" height="29" align="LEFT" hspace="9"></p>		<p><b>(20</b>.20)</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><b>Periodic Signals</b></p>		<div align="justify">			<p>The signals <img src="Image54.gif" width="42" height="15">, <img src="Image55.gif" width="43" height="15"> and <img src="Image60.gif" width="23" height="12"> are all <i>periodic</i> signals, meaning that for some value <img src="Image61.gif" width="9" height="10">, the signal <img src="Image62.gif" width="60" height="15">. If <img src="Image63.gif" width="10" height="13"> in <img src="Image54.gif" width="42" height="15">, <img src="Image55.gif" width="43" height="15">, or <img src="Image60.gif" width="23" height="12"> is not equal to 0, then the smallest positive value of <img src="Image61.gif" width="9" height="10"> for which <img src="Image62.gif" width="60" height="15"> is called the <i>fundamental period</i>, <img src="Image64.gif" width="11" height="13">. <img src="Image65.gif" width="41" height="15">. For an arbitrary periodic signal (where <img src="Image66.gif" width="63" height="15">), <img src="Image63.gif" width="10" height="13"> is called the <i>fundamental frequency</i>.</p>		</div>		<p><img src="Image67.gif" width="328" height="141"></p>		<p><b>Figure 20.3</b> A periodic signal.</p>		<div align="justify">			<p>In the abstract world of signals, a periodic signal like <img src="Image54.gif" width="42" height="15"> started before the dawn of time and goes on past the end of the universe. Those of us who are not deity do not have the patience to listen to such signals. Our signals have to have a start and an end. For us mere mortals, a reasonably long section of <img src="Image54.gif" width="42" height="15"> can be generated by:</p>		</div>		<p><img src="Image68.gif" width="111" height="223" hspace="9"></p>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><b>Figure 20.4</b> Block diagram of <i>instr 2001</i>, a 440 Hz sinusoidal oscillator at full amplitude synthesized mathematically by solving for <i>sin(x).</i></p>		<p>		<table cellspacing="0" border="0"  width="477">			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td width="13%" valign="top"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td width="15%" valign="top"><a href="../../Book%20Instruments/20/2001/2001.html"><font face="Courier" size="2">2001</font></a></td>				<td width="61%" valign="top"><font face="Courier" size="2">; 440 hz sine wave at full amp</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">itwopi</font></td>				<td width="13%" valign="top"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">2*3.141592653589793238</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a1</font></td>				<td width="13%" valign="top"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/phasor.htm"><font face="Courier" size="2">phasor</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">440</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a2</font></td>				<td width="13%" valign="top"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">32767*sin(itwopi*a1)</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td width="13%" valign="top"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">a2</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td width="13%" valign="top"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>				<td valign="top" colspan="2">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="4">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2001</font></td>				<td width="13%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">5</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.5</b> Orchestra and score code for <i>instr 2001</i>, a sine wave synthesizer as shown in figure 20.4.</p>		<div align="justify">			<p>Csound has some special facilities for generating periodic signals, but we need to wait for a little more background before we fully understand how they work. Let us listen to the examples first and then learn how they work.</p>		</div>		<p><img src="Image69.gif" width="91" height="119" hspace="9"></p>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><b>Figure 20.6</b> Block diagram of <i>instr 2002</i>, a simple Csound oscillator instrument.</p>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="5"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="5"><a href="../../Book%20Instruments/20/2002/2002.html"><font face="Courier" size="2">2002</font></a></td>				<td width="61%" valign="top"><font face="Courier" size="2">; simple 440hz oscillator</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">aprd</font></td>				<td valign="top" colspan="5"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="6"><font face="Courier" size="2">32767, 440, p4</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="5"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="6"><font face="Courier" size="2">aprd</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="11"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="12">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="12"><font face="Courier" size="2">; One period of a sine wave</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">8192</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">1</font></td>			</tr>			<tr>				<td valign="top" colspan="12"><font face="Courier" size="2">; One period of an approximate sawtooth wave</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 2</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">8192</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">1 0.5 0.333 0.25 0.2 0.1667 0.1429 0.125 0.111 0.1</font></td>			</tr>			<tr>				<td valign="top" colspan="12"><font face="Courier" size="2">; One period of an approximate square wave</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 3</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">8192</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">1 0 0.333 0 0.2 0 0.1429 0 0.111 0</font></td>			</tr>			<tr>				<td valign="top" colspan="12"><font face="Courier" size="2">; One period of an approximate triangle wave</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 4</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">8192</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1 0 -0.111 0 0.04 0 -0.0204 0 0.0123 0 -0.0083 0 0.0059</font></td>			</tr>			<tr>				<td valign="top" colspan="12">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2002</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td width="4%" valign="top"><font face="Courier" size="2">5</font></td>				<td valign="top" colspan="8"><font face="Courier" size="2">1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2002</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">6</font></td>				<td width="4%" valign="top"><font face="Courier" size="2">5</font></td>				<td valign="top" colspan="8"><font face="Courier" size="2">2</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2002</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">12</font></td>				<td width="4%" valign="top"><font face="Courier" size="2">5</font></td>				<td valign="top" colspan="8"><font face="Courier" size="2">3</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2002</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">18</font></td>				<td width="4%" valign="top"><font face="Courier" size="2">5</font></td>				<td valign="top" colspan="8"><font face="Courier" size="2">4</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.7</b> Score code for <i>instr 2002</i> with function for sine, saw, square and triangle called consecutively by each note.</p>		<div align="justify">			<p>Since for a periodic function, <img src="Image62.gif" width="60" height="15">, we do not really have to let time go from the start to the end, we can just let time run from 0 to <i>T</i> and then start over. If we have a new variable, say <img src="Image70.gif" width="9" height="11">, defined as <img src="Image71.gif" width="37" height="12">, then we can generate <img src="Image72.gif" width="18" height="15"> by letting <img src="Image70.gif" width="9" height="11"> run from 0 to 1 and then start over at 0.</p>		</div>		<p><b>Discrete Signals</b></p>		<div align="justify">			<p>The other class of signals, discrete-time signals, only has values at fixed instants of time. For example, the closing value of the Dow Jones industrial average is a discrete-time signal which only has a value determined at the closing bell (4 p.m. Eastern Time). In between the closing bells, the closing value is undefined. In other words, it makes no sense to talk about the closing-bell value at noon. Discrete-time signals are often represented graphically as &quot;lollipop diagrams,&quot; where the height of the lollipop stick corresponds to the value of the signal at that time. The lollipop itself is meant to remind you that the function only has values at discrete points.</p>		</div>		<div align="justify">			<p>Because a discrete-time signal only has a value at discrete times, we can number these discrete times, <i>e.g.</i> <img src="Image73.gif" width="9" height="13">, <img src="Image74.gif" width="9" height="13">, <img src="Image75.gif" width="9" height="13">, ... The values of the discrete-time signal, <img src="Image76.gif" width="8" height="8">, can then be represented as either <img src="Image77.gif" width="22" height="15">, <img src="Image78.gif" width="22" height="15">, <img src="Image79.gif" width="22" height="15">, ..., or <img src="Image80.gif" width="19" height="14">, <img src="Image81.gif" width="18" height="14">, <img src="Image82.gif" width="19" height="14">, ..., where <img src="Image83.gif" width="50" height="15"> and <i>n</i> is called the <i>index variable</i>.</p>		</div>		<div align="justify">			<p>The natural representation of a signal in a computer is as a discrete-time signal. A computer has individual memory or storage locations, so the values of a discrete-time signal can be stored in successive memory locations. Csound has a lot of built-in facilities for generating and storing discrete-time signals.</p>		</div>		<p><img src="Image84.gif" width="252" height="197"></p>		<p><b>Figure 20.8</b> A discrete-time signal.</p>		<div align="justify">			<p>The GEN routines (in the <i>.sco</i> file) all create discrete-time signals and store them in a section of memory known as a <i>table</i>. You use an <i>index</i> into a table to find a stored value of the function. You can store a complete discrete-time signal in the computer using a GEN routine and then generate the signal by indexing the table with the integers from 0 to <i>table</i>-<i>length</i>-1. Since tables can be of different lengths, it is sometimes easier to say you want a value halfway through the table or three-quarters of the way through the table, instead of at index 4095. The Csound opcode <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a> lets you access the table either way. The line:</p>		</div>		<p>		<table cellspacing="0" border="0"  width="473">			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">a1</font></td>				<td width="14%" valign="top"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><font face="Courier" size="2">table</font></a></td>				<td width="76%" valign="top"><font face="Courier" size="2">73, 1, 0</font></td>			</tr>		</table>		</p>		<div align="justify">			<p>will assign <i>a1</i> the value at index 73 in function table (f-table) 1. The line:</p>		</div>		<p>		<table cellspacing="0" border="0"  width="477">			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">a2</font></td>				<td width="14%" valign="top"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><font face="Courier" size="2">table</font></a></td>				<td width="77%" valign="top"><font face="Courier" size="2">0.25, 2, 1</font></td>			</tr>		</table>		</p>		<div align="justify">			<p>will assign <i>a2</i> the value one quarter of the way through f-table 2.</p>			<p>One advantage of <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a> is that you do not have to access the values in order. If you access the <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a> in reverse order, you will have the function going in reverse. You can access the <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a> in any sort of order and create a different signal for each order of access.</p>			<p>In order to access the entire <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a> you need some way to generate all of the integers from 0 to the <i>table-length</i>-1, at a fixed rate. The Csound opcode <a href="../../../2%20CD1/Reference/Manual4.0/siggen/phasor.htm"><b>phasor</b></a> generates normalized indices (that run from 0 to 1) at a rate you specify. You can either multiply the output of <a href="../../../2%20CD1/Reference/Manual4.0/siggen/phasor.htm"><b>phasor</b></a> by the <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a> length, or set it to use normalized indices. The <a href="../../../2%20CD1/Reference/Manual4.0/siggen/phasor.htm"><b>phasor</b></a> opcode generates indices that run from 0 to 1 and then it resets back to 0 and repeats. It behaves just like we wanted our variable <img src="Image85.gif" width="9" height="11"> to behave.</p>			<p>There are two ways to change the frequency of a waveform stored in a table. You can change the length of time between samples, or you can change the number of samples skipped between times. Csound uses the latter approach. For example, if you keep the sampling rate the same, but only use every other sample, you double the frequency. If you use every third sample, you triple the frequency. That is essentially how <a href="../../../2%20CD1/Reference/Manual4.0/siggen/phasor.htm"><b>phasor</b></a> works. It uses the specified frequency to determine the size of jump it will take in a <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a>.</p>			<p>We can create a discrete-time periodic signal by using the output of <a href="../../../2%20CD1/Reference/Manual4.0/siggen/phasor.htm"><b>phasor</b></a> to index a table containing one period of our periodic signal. In fact, the Csound opcode <a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><b>oscil</b></a> combines a <a href="../../../2%20CD1/Reference/Manual4.0/siggen/phasor.htm"><b>phasor</b></a> with a <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a>. To summarize, you can generate a discrete-time periodic signal in Csound by filling a <a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a> with one period of a function and then using either a <a href="../../../2%20CD1/Reference/Manual4.0/siggen/phasor.htm"><b>phasor</b></a> -<a href="../../../2%20CD1/Reference/Manual4.0/siggen/table.htm"><b>table</b></a> pair or an <a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><b>oscil</b></a>.</p>			<p>A natural question then arises: How can one convert a discrete-time signal such as the output from Csound into a continuous signal, such as a sound? Or how can one convert a continuous-time signal such as a sound into a discrete-time signal, such as an <i>.aif</i> file? Under a very specific criterion, known as the <i>sampling theorem</i>, these tasks can be accomplished exactly, without the loss or addition of any information. But before we discuss the sampling theorem, we have a few additional topics to cover.</p>		</div>		<p><b>Fourier Series</b></p>		<div align="justify">			<p>It was discovered long ago that any reasonable periodic signal (one that has a maximum value less than infinity and a finite number of wiggles or jumps in a period) can be represented as a weighted sum of integrally-related (meaning that the frequencies are related by integers) sines and cosines or complex exponentials. This weighted sum is known as a <i>Fourier series</i> and the weightings are known as the <i>Fourier coefficients</i>. Mathematically, the periodic signal <img src="Image86.gif" width="18" height="15"> is given by the sum:</p>		</div>		<p><img src="Image87.gif" width="78" height="31">(20.21)</p>		<div align="justify">			<p>where the summation is the Fourier series and the <img src="Image88.gif" width="11" height="13"> are the Fourier coefficients. If the periodic function is an even function, the complex exponentials can be rewritten as cosines:</p>		</div>		<p><img src="Image89.gif" width="93" height="31">(20.22)</p>		<div align="justify">			<p>If the periodic function is an odd function, the complex exponentials can be rewritten as sines:</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><img src="Image90.gif" width="91" height="31">(20.23)</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<div align="justify">			<p>The <img src="Image88.gif" width="11" height="13"> can be calculated by evaluating the integral of the product of the function and the appropriate complex exponential over one period and dividing by the period. Mathematically:</p>		</div>		<p><img src="Image91.gif" width="92" height="30">(20.24)</p>		<div align="justify">			<p>A set of sines, cosines or complex exponentials, where the frequencies are related by <img src="Image92.gif" width="32" height="13">, where <img src="Image93.gif" width="78" height="12"> are said to be <i>harmonically related</i> and the individual terms are called the <i>harmonics</i> or <i>partials</i>. The terms where <img src="Image94.gif" width="28" height="11"> are called the fundamental harmonic or fundamental. The terms where <img src="Image95.gif" width="29" height="11"> are called the second harmonic or second partial. The terms where <img src="Image96.gif" width="29" height="11"> are called the third harmonic or third partial and so forth. Much of the tone quality or timbre of a musical note is governed by the number and relative strengths of the harmonics in the note. As an interesting side-note: the <img src="Image88.gif" width="11" height="13"> can be thought of as a discrete-time signal.</p>		</div>		<div align="justify">			<p>The Csound function generators, GEN9, GEN10 and GEN19 are designed to create a table with one period of a periodic function from the Fourier coefficients. They differ in the amount of detail you have to specify about each harmonic. As an example, a sawtooth wave (which is an odd function) has the following Fourier series:</p>		</div>		<p><img src="Image97.gif" width="103" height="31">(20.25)</p>		<div align="justify">			<p>and the Fourier coefficients are given by:</p>		</div>		<p><img src="Image98.gif" width="39" height="24">(20.26)</p>		<div align="justify">			<p>Since the GEN routines automatically rescale the functions, we can ignore the 2/<i>&#185;</i> and just use 1/<i>k</i> as the Fourier coefficients. The first ten coefficients are 1, 1/2, 1/3, 1/4, 1/5, 1/6, 1/7, 1/8, 1/9 and 1/10. The more terms we include, the closer we get to a sawtooth wave. In Csound we would include the following line in the score file to create a table with one period of an approximate sawtooth wave.</p>		</div>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td width="7%" valign="top"><font face="Courier" size="2">f 2</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td width="10%" valign="top"><font face="Courier" size="2">16384</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">10</font></td>				<td width="71%" valign="top"><font face="Courier" size="2">1 0.5 0.3333 0.25 0.2 0.1667 0.1429 0.125 0.1111 0.1</font></td>			</tr>		</table>		</p>		<p><img src="Image99.gif" width="268" height="210"></p>		<p><b>Figure 20.9</b> Sawtooth Fourier coefficients.</p>		<div align="justify">			<p>Other common periodic signals are the square wave:</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><img src="Image100.gif" width="104" height="31">, <img src="Image101.gif" width="100" height="38">(20.27)</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<p>		<table cellspacing="0" border="0"  width="473">			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td width="9%" valign="top"><font face="Courier" size="2">0</font></td>				<td width="14%" valign="top"><font face="Courier" size="2">16384</font></td>				<td width="10%" valign="top"><font face="Courier" size="2">10</font></td>				<td width="58%" valign="top"><font face="Courier" size="2">1 0 0.3333 0 0.2 0 0.1429 0 0.1111 0</font></td>			</tr>		</table>		</p>		<div align="justify">			<p>The triangle wave:</p>		</div>		<p><img src="Image102.gif" width="148" height="32">, <img src="Image103.gif" width="138" height="41"> 20.28)</p>		<p>		<table cellspacing="0" border="0"  width="500">			<tr>				<td width="6%" valign="top"><font face="Courier" size="2">f 3</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td width="10%" valign="top"><font face="Courier" size="2">16384</font></td>				<td width="6%" valign="top"><font face="Courier" size="2">10</font></td>				<td width="73%" valign="top"><font face="Courier" size="2">1 0 -0.1111 0 0.04 0 -0.0204 0 0.0123 0 -0.0083 0 0.0059</font></td>			</tr>		</table>		</p>		<div align="justify">			<p>If your calculus is not really sharp, you can use a program such as <i>Mathematica</i> to calculate the Fourier coefficients for you. You still have to come up with an expression for one period of the periodic function. But <i>Mathematica</i> will then calculate the Fourier series and the Fourier coefficients.</p>		</div>		<p><img src="Image104.gif" width="268" height="214"></p>		<p><b>Figure 20.10</b> Square wave Fourier coefficients</p>		<p><img src="Image105.gif" width="268" height="201"></p>		<p><b>Figure 20.11</b> Triangle wave Fourier coefficients.</p>		<div align="justify">			<p>For example, one period of a sawtooth wave is described by <img src="Image106.gif" width="56" height="15">. The following <i>Mathematica</i> commands will give you the first ten terms of the Fourier series and also give you the first ten coefficients.</p>		</div>		<p>&lt;&lt;Calculus 'Fourier Transform'</p>		<p>y=-(2x-1)</p>		<p>FourierTrigSeries[y,{x,0,1},10]</p>		<p>Table[Pi/2 FourierSinSeriesCoefficient[y,{x,0,1},n],{n,1,10}]</p>		<p><b>The Fourier Transform</b></p>		<div align="justify">			<p>Not all signals are periodic. It turns out that even aperiodic continuous-time signals can be constructed from the sum of sines and cosines or complex exponentials. However, we need the weighted sum of sines and cosines or complex exponentials at all possible frequencies, instead of at just harmonically related frequencies. The mathematical way to sum lots of little bits right next to each other is to integrate. Instead of the discrete <img src="Image88.gif" width="11" height="13"> we had for the Fourier series, we now have a continuous function of frequency, so the continuous-time signal <img src="Image107.gif" width="18" height="15"> can be constructed from the weighted sum of all frequencies with the weighting function being <img src="Image108.gif" width="22" height="15">, <i>i.e.</i>:</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><img src="Image109.gif" width="85" height="33">(20.29)</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<div align="justify">			<p>We can evaluate <img src="Image108.gif" width="22" height="15"> from <img src="Image107.gif" width="18" height="15"> with the formula:</p>		</div>		<p><img src="Image110.gif" width="89" height="33">(20.30)</p>		<div align="justify">			<p>The equation for calculating <img src="Image108.gif" width="22" height="15"> is called the <i>Fourier Transform</i>. The equation for reconstructing <img src="Image107.gif" width="18" height="15"> from <img src="Image108.gif" width="22" height="15"> is called the <i>Inverse Fourier Transform</i>. The importance for us in these transforms is that we now have two ways of looking at a continuous-time signal. We can look at it as a function of time (<i>time domain</i>), or as a function of frequency (<i>frequency domain</i>). Since humans hear the pitches of notes as a function of frequency and not as functions of time, the frequency domain is often a valuable place to examine musical signals.</p>		</div>		<div align="justify">			<p>Plotted below is the function:</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><img src="Image111.gif" width="74" height="30">(20.31)</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<div align="justify">			<p>and its Fourier transform. The plots were generated with <i>Mathematica</i> from the following instructions:</p>		</div>		<p>&lt;&lt;Calculus`FourierTransform`</p>		<p>foft=UnitStep[t]Exp[-t]</p>		<p>fofw=FourierTransform[foft,t,w]</p>		<p>foff=fofw/.w-&gt;2 Pi f</p>		<p>Plot[foft,{t,-5,5}]</p>		<p>Plot[Abs[foff],{f,-5,5}]</p>		<p>Plot[Arg[foff],{f,-5,5}]</p>		<p><img src="Image112.gif" width="342" height="216"></p>		<p><b>Figure 20.12</b> The function of time.</p>		<p><img src="Image113.gif" width="342" height="216"></p>		<p><b>Figure 20.13</b> The magnitude of its Fourier transform.</p>		<p><img src="Image114.gif" width="342" height="216"></p>		<p><b>Figure 20.14</b> The phase of its Fourier transform.</p>		<div align="justify">			<p>For discrete-time or sampled signals, the discrete-time Fourier transform is calculated as:</p>		</div>		<p><img src="Image115.gif" width="92" height="31">(20.32)</p>		<div align="justify">			<p>where the frequency <i>F</i> is given as a fraction of the sampling frequency. <img src="Image116.gif" width="23" height="15"> is a continuous periodic function with a period of 1. The inverse transform is:</p>		</div>		<p><img src="Image117.gif" width="98" height="28">(20.33)</p>		<div align="justify">			<p>The integration is performed over any range of <i>F</i> with a length of 1, <i>e.g.</i> 0 to 1 or -1/2 to 1/2. We will make use of both of these formulas in the section on filters.</p>		</div>		<div align="justify">			<p>Because the Fourier transform can consist of complex numbers, it is customary to plot functions in the frequency domain as a plot of magnitude (or absolute value) versus frequency and phase (or phase angle or argument) versus frequency. Csound has a built-in function for plotting the magnitude of a Fourier transform but not the phase. The opcode <a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><b>dispfft</b></a> and the analysis program <a href="../../../2%20CD1/Reference/Manual4.0/utility/pvanal.htm"><b>pvanal</b></a> use the <i>Fast Fourier Transform</i> (FFT), which is a very efficient method for calculating a sampled version of the discrete-time Fourier transform.</p>		</div>		<p><b>The Impulse</b></p>		<div align="justify">			<p>An aperiodic signal with a special place in signal processing is the <i>impulse</i>, <img src="Image118.gif" width="18" height="12">. A continuous-time impulse is a strange limiting case of taking a signal, like a rectangular pulse and making it narrower and narrower, while increasing the height in such a way that the area remains constant. The true impulse (like the ideal fashion model) is infinitely tall and infinitely thin but has an area of 1. The discrete-time impulse, <img src="Image119.gif" width="20" height="14">, is much simpler. It is a single sample of value 1 surrounded by zeros.</p>		</div>		<div align="justify">			<p>The impulse has several properties that make it useful. The first is its sampling property. You can find the value of a function at a given time <img src="Image120.gif" width="10" height="13"> or index <img src="Image121.gif" width="12" height="13">, with the following formulas: the integral (or sum) of the product of the impulse and a function is the value of the function at the impulse&#146;s time, <i>i.e.</i>:</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><img src="Image122.gif" width="98" height="33">(20.34)</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<div align="justify">			<p>or</p>		</div>		<p><img src="Image123.gif" width="102" height="29">(20.35)</p>		<div align="justify">			<p>This property is most useful in designing FIR filters (described below). The second property is the impulse&#146;s frequency content. The Fourier transform of the impulse is a constant, <i>i.e</i>.:</p>		</div>		<p><img src="Image124.gif" width="7" height="13"><img src="Image125.gif" width="146" height="33">(20.36)</p>		<div align="justify">			<p>or</p>		</div>		<p><img src="Image126.gif" width="142" height="29">(20.37)</p>		<p>In other words, an impulse contains all possible frequencies in equal strength. That property makes it ideal for testing filters and evaluating their performance.</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><b>Figure 20.15</b> The discrete-time impulse.</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><b>Figure 20.16</b> The Fourier transform of the discrete-time impulse.</p>		<div align="justify">			<p>You cannot really hear an impulse. But you can hear the impulse response of your computer and sound system (I will explain what an impulse response is a little later). The following Csound code will generate an impulse to let you hear the impulse response of your computer and sound system.</p>		</div>		<p><img src="Image127.gif" width="305" height="191"></p>		<p><b>Figure 20.17</b> Block diagram of <i>instr 2003</i>, an instrument which generates an impulse and displays it in both the time and frequency domains to let you hear and measure the impulse response of your system.</p>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">kr</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">44100</font></td>				<td width="53%" valign="top"><font face="Courier" size="2">; avoid problems</font></td>			</tr>			<tr>				<td valign="top" colspan="10">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">kr</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">44100</font></td>				<td width="53%" valign="top"><font face="Courier" size="2">; avoid problems</font></td>			</tr>			<tr>				<td valign="top" colspan="10">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="2"><a href="../../Book%20Instruments/20/2003/2003.html"><font face="Courier" size="2">2003</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; single impulse</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">idur1</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">7/sr</font></td>				<td width="53%" valign="top"><font face="Courier" size="2">; read the table once</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">idur2</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1/sr</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">ifreq</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">sr/8</font></td>				<td width="53%" valign="top"><font face="Courier" size="2">; read the table at 1 point per sample</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">ifreq, idur1, ifreq, idur2, 0, 1, 0</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">32767, a1, 1</font></td>				<td width="53%" valign="top"><font face="Courier" size="2">; scale the amplitude so you can hear it</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a2</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">display</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">a1, p3</font></td>				<td width="53%" valign="top"><font face="Courier" size="2">; display the impulse response</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">dispfft</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">a1, p3, 4096, 0, 1</font></td>				<td width="53%" valign="top"><font face="Courier" size="2">; DISPLAY THE frequency response</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="8"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="10">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="10"><font face="Courier" size="2">; create a table with an impulse in the second position</font></td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">8</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">2</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">0 1 0 0 0 0 0 0 0</font></td>			</tr>			<tr>				<td valign="top" colspan="10"><font face="Courier" size="2">; Play the impulse and wait a while</font></td>			</tr>			<tr>				<td valign="top" colspan="3"><font face="Courier" size="2">i 2003</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">0.2</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.18</b> Orchestra and score code for <i>instr 2003</i> that generates a single impulse and displays the impulse and frequency response.</p>		<div align="justify">			<p>Often one does not want an impulse with all possible frequencies, but rather a periodic or pitched signal with all of the harmonics at equal strength. A train of impulses will have the desired characteristics. Unfortunately, in a sampled system, the period of a pulse-train must be an integer multiple of the sampling period, which greatly limits the frequencies that can be used. Csound provides a way around this limitation. The opcode <a href="../../../2%20CD1/Reference/Manual4.0/siggen/buzz.htm"><b>buzz</b></a> is designed to provide a signal with equal-strength harmonics for any desired frequency. The following Csound instrument will give you a <a href="../../../2%20CD1/Reference/Manual4.0/siggen/buzz.htm"><b>buzz</b></a>.</p>		</div>		<p><img src="Image128.gif" width="245" height="210" hspace="9"></p>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><b>Figure 20.19</b> Block diagram of <i>instr 2004</i>, an instrument which generates a pitched &quot;impulse train&quot; using Csound&#146;s <a href="../../../2%20CD1/Reference/Manual4.0/siggen/buzz.htm"><b>buzz</b></a> opcode.</p>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="4"><a href="../../Book%20Instruments/20/2004/2004.html"><font face="Courier" size="2">2004</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; pitched PULSE train</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">iharm</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">int(44100/(p4&gt;p5 p4:p5)/2)-1</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; max harm w/o alias</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="6"><font face="Courier" size="2">0, 0.05, 30000, p3-0.1, 30000, 0.05, 0, 1, 0</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">afreq</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">expon</font></a></td>				<td valign="top" colspan="6"><font face="Courier" size="2">p4, p3, p5</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/buzz.htm"><font face="Courier" size="2">buzz</font></a></td>				<td valign="top" colspan="6"><font face="Courier" size="2">1, afreq, iharm, 1, -1</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="6"><font face="Courier" size="2">a1*a2</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="10"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="11">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td width="6%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">16384</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">1</font></td>			</tr>			<tr>				<td valign="top" colspan="11">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2004</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">20</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2004</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">6</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">20</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">40</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2004</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">12</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">40</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">80</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2004</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">18</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">80</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">160</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2004</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">24</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">160</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">320</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2004</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">30</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">320</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">640</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.20</b> Orchestra and score code for <i>instr 2004</i>, an instrument which generates a sweeping train of impulses with all the harmonics at equal strength.</p>		<div align="justify">			<p>As the frequency sweeps from 10 Hz to 640 Hz you should hear the transition from individual clicks to a buzzing sound. The transitions (the car shifts) are because one has to specify the number of harmonics in <a href="../../../2%20CD1/Reference/Manual4.0/siggen/buzz.htm"><b>buzz</b></a> and the maximum number allowed without aliasing (explained below) decreases with increasing frequency.</p>		</div>		<div align="justify">			<p>Often a signal will have one or more frequency ranges where there is no information, which means that <img src="Image129.gif" width="38" height="15">. Such a signal is called <i>band-limited</i>, meaning the information content is limited to certain frequency ranges or bands.</p>		</div>		<p><img src="Image130.gif" width="313" height="208"></p>		<p><b>Figure 20.21 </b>A band-limited signal.</p>		<p><b>The Sampling Theorem and Aliasing</b></p>		<div align="justify">			<p>With this background we are ready to tackle converting continuous signals to discrete signals and back. The <i>Sampling Theorem</i> states that a band-limited continuous signal with <img src="Image129.gif" width="38" height="15"> for <img src="Image131.gif" width="31" height="15"> is uniquely determined by its samples, if the sampling frequency is at least twice the band-limited frequency, <img src="Image132.gif" width="35" height="13">, where the sampling frequency is the reciprocal of the sampling period <img src="Image133.gif" width="40" height="13">. The original signal, <img src="Image134.gif" width="18" height="15">, can be reconstructed from its samples by generating an impulse-train whose amplitudes equal the sample values and passing the impulse-train through an ideal lowpass filter with a gain of <img src="Image135.gif" width="11" height="13"> and a cutoff frequency greater than <img src="Image136.gif" width="13" height="13"> and less than <img src="Image137.gif" width="29" height="13">.</p>		</div>		<div align="justify">			<p>The analog-to-digital (ADC) and digital-to-analog (DAC) converters in your computer or sound card usually handle the details of converting from a continuous signal to a discrete signal and back again. Most ADC&#146;s have filters on them to remove any frequency content higher than one-half the sample rate. When recording a signal into a computer then, one normally does not have to worry about making sure that the signal is band-limited.</p>		</div>		<div align="justify">			<p>However, when generating or processing a signal inside the computer one has to be careful not to generate any frequency content above one-half the sample rate. Csound has <i>absolutely</i> no built-in protection against this. There is in fact no general way for protection against this.</p>		</div>		<div align="justify">			<p>If you generate a frequency above one-half of the sampling rate and attempt to play it, the actual frequency you hear will depend upon just how high above one-half the sampling rate the frequency is. For frequencies between <img src="Image138.gif" width="26" height="13"> and <img src="Image139.gif" width="9" height="13">, the frequency you will hear is <img src="Image140.gif" width="24" height="13">. For frequencies between <img src="Image139.gif" width="9" height="13"> and <img src="Image141.gif" width="27" height="13">, the frequency you will hear is <img src="Image142.gif" width="23" height="13">. The pattern repeats.</p>		</div>		<div align="justify">			<p>This reappearance of a high frequency as a much lower frequency is called <i>aliasing</i>, (<i>i.e.</i> the high frequency appears as its low-frequency alias). The following Csound code illustrates aliasing:</p>		</div>		<p><img src="Image143.gif" width="206" height="174"></p>		<p><b>Figure 20.22</b> Block diagram of <i>instr 2005</i>, an instrument designed to illustrate the sounds and concepts of aliasing.</p>		<p>		<table cellspacing="0" border="0"  width="477">			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="3"><a href="../../Book%20Instruments/20/2005/2005.html"><font face="Courier" size="2">2005</font></a></td>				<td width="61%" valign="top"><font face="Courier" size="2">; aliasing</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">0, 0.01, 20000, p3-0.01, 20000, 0.01, 0, 1, 0</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">expon</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">20, p3, 176400</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">a3</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a1, a2, p4</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a3</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="7"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="9">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="9"><font face="Courier" size="2">; sine</font></td>			</tr>			<tr>				<td width="7%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">8192</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">1</font></td>			</tr>			<tr>				<td valign="top" colspan="9"><font face="Courier" size="2">; square</font></td>			</tr>			<tr>				<td width="7%" valign="top"><font face="Courier" size="2">f 2</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">8192</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">1000 0 333 0 200 0 143 0 111 0 91 0 77 0 67 0 59 0 53 0</font></td>			</tr>			<tr>				<td valign="top" colspan="9"><font face="Courier" size="2">; sawtooth</font></td>			</tr>			<tr>				<td width="7%" valign="top"><font face="Courier" size="2">f 3</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">8192</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">1000 500 333 250 200 167 143 125 111 100 91 83 77 71 67 63 59 56 53 50</font></td>			</tr>			<tr>				<td valign="top" colspan="9"><font face="Courier" size="2">; impulse-like</font></td>			</tr>			<tr>				<td width="7%" valign="top"><font face="Courier" size="2">f 4</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">8192</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</font></td>			</tr>			<tr>				<td valign="top" colspan="9">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="3"><font face="Courier" size="2">i 2005</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">20</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">1</font></td>			</tr>			<tr>				<td valign="top" colspan="3"><font face="Courier" size="2">i 2005</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">21</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">20</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">2</font></td>			</tr>			<tr>				<td valign="top" colspan="3"><font face="Courier" size="2">i 2005</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">42</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">20</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">3</font></td>			</tr>			<tr>				<td valign="top" colspan="3"><font face="Courier" size="2">i 2005</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">63</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">20</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">4</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.23</b> Orchestra and score code for <i>instr 2005</i>, an instrument whose frequency moves from 20 Hz to 176,400 Hz &#151; 4x the sample rate.</p>		<div align="justify">			<p>The result sweeps the waveform from 20 Hz to 176,400 Hz, which is four times the sample rate. Humans cannot hear sounds at 176,400 Hz, but you will hear the alias of 176,400 Hz quite clearly. For the sine wave you should be able to hear the pitch sweep up and down four times. For the others, you will hear the partials sweep up and down repeatedly before the fundamental starts to sweep back down. For the <a href="../../../2%20CD1/Reference/Manual4.0/siggen/buzz.htm"><b>buzz</b></a> wave, all of the harmonics are the same strength so you will hear an audio mess.</p>		</div>		<p><img src="Image144.gif" width="267" height="155"></p>		<p><b>Figure 20.24</b> Aliasing</p>		<div align="justify">			<p>Aliasing is neither a good nor a bad thing. However, If you are not expecting it, you can generate &quot;noise&quot; (my definition of &quot;noise&quot; is any sound that you do not want to hear). It is best not to depend on aliasing in a Csound instrument, because changing the sampling rate will dramatically change the sound. Another way to think about aliasing is that the discrete-time frequency, <img src="Image145.gif" width="39" height="13">, only has a useful range from -1/2 to 1/2. Any frequency generated outside this range will be aliased back into this range. The most common causes of aliasing in Csound are sampling a table too rapidly or having too high a modulation index in a modulating scheme such as FM (discussed below).</p>		</div>		<p><b>Systems</b></p>		<div align="justify">			<p>A <i>system</i> is anything that takes an input signal and transforms it into an output signal. Systems are normally classified as either <i>linear</i> or <i>non-linear</i> and <i>time-invariant</i> or <i>time-varying</i>. A time-invariant system is one in which a given input causes a given output no matter when the input occurs. For example, consider a doorbell as a system with a push on the button as the input and the ringing sound as the output. It does not matter when you push the button, the bell will still ring, so the system is time-invariant. However, if you consider the system to be the doorbell, the residents and the front door, taken all together as the system, this new system is time-varying, <i>i.e.</i> the response that you get to a push on the doorbell depends very much on the time of day. Mathematically a system is time-invariant if the input <img src="Image146.gif" width="35" height="15"> gives rise to the output <img src="Image147.gif" width="35" height="15">.</p>		</div>		<div align="justify">			<p>A linear system is one in which the output is directly proportional to the input. Most doorbells are not linear because pushing the button twice as hard does not cause the bell to ring twice as loud. A properly functioning grocery clerk is a linear system because they will charge you twice as much for two boxes of corn flakes and they will charge you the sum of three times the price of one box of corn flakes and twice the price of one doughnut if you buy three boxes of corn flakes and two doughnuts.</p>		</div>		<div align="justify">			<p>Mathematically, a linear system has the following properties: if <img src="Image148.gif" width="22" height="15"> and <img src="Image149.gif" width="23" height="15"> are inputs to a system, <i>a</i> and <i>b</i> are constants and <img src="Image150.gif" width="22" height="15"> is the system response to <img src="Image148.gif" width="22" height="15"> and <img src="Image151.gif" width="23" height="15"> is the system response to <img src="Image149.gif" width="23" height="15">, then the system is linear if the response to<img src="Image152.gif" width="60" height="15"> is<img src="Image153.gif" width="60" height="15">.</p>		</div>		<div align="justify">			<p>From a design and analysis standpoint, linear time-invariant systems are the most useful because you can predict their behavior from very limited information. Most of the rest of this chapter will be concerned with linear time-invariant (LTI) systems.</p>		</div>		<p><img src="Image154.gif" width="227" height="136"></p>		<p><b>Figure 20.25</b> Block diagram of linear time-invariant systems in the time and frequency domains.</p>		<p><b>Impulse Response and Convolution</b></p>		<div align="justify">			<p>If you input an impulse into an LTI system you will get an output signal called the <i>impulse response</i>, <img src="Image155.gif" width="18" height="15">, for continuous systems and <img src="Image156.gif" width="19" height="14"> for discrete systems. It has been proven that you can get the response to any input signal, <img src="Image107.gif" width="18" height="15">, from the impulse response by <i>convolution</i> of <img src="Image107.gif" width="18" height="15"> with <img src="Image155.gif" width="18" height="15">. The symbol for convolution is usually the asterisk &#151; &quot;<img src="Image157.gif" width="7" height="7">.&quot; For continuous signals:</p>		</div>		<p><img src="Image158.gif" width="144" height="33"> (20.38)</p>		<div align="justify">			<p>For discrete signals:</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><img src="Image159.gif" width="145" height="29"> (20.39)</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<div align="justify">			<p>For discrete systems with short impulse responses, the convolution sum is fairly easy to program and runs quite quickly. However, for long impulse responses, such as reverberation in a cathedral, the speed and memory requirements for convolution become quite overwhelming. Most people do not have the mathematical background to perform the convolution integral for continuous signals and we have found that even among those that do, relatively few enjoy performing the integration. It would be nice if there was an easier way. A special property of sines, cosines and complex exponentials provides such a way.</p>		</div>		<p><b>Frequency Response and Convolution</b></p>		<div align="justify">			<p>Sines, cosines and complex exponentials are <i>eigen functions</i> of LTI systems, which means that the output from a complex exponential input is a complex exponential with exactly the same frequency. However, the output is multiplied by a (possibly complex) constant. In other words, for an input of <img src="Image160.gif" width="21" height="12"> you get an output of <img src="Image161.gif" width="41" height="15">, where <img src="Image162.gif" width="23" height="15"> is a constant that depends on <i>f</i> but not on <i>t</i>. Since we learned above that any reasonable signal can be constructed from a weighted sum (or integral) of complex exponentials, we can find the response of an LTI system as:</p>		</div>		<p><img src="Image163.gif" width="106" height="33"> or <img src="Image164.gif" width="72" height="15">(20.40)</p>		<div align="justify">			<p>For discrete-time systems the result is <img src="Image165.gif" width="76" height="15">. You may have guessed by now that <img src="Image162.gif" width="23" height="15"> is the Fourier transform of the impulse response, <img src="Image155.gif" width="18" height="15">. <img src="Image162.gif" width="23" height="15"> is the <i>transfer function</i> or <i>frequency-response function</i> of the system. In other words, multiplication in the frequency domain corresponds to convolution in the time domain. The procedure then is to take the Fourier transform of the input signal and the impulse response, multiply the two transforms and take the inverse transform of the result to get the output signal.</p>		</div>		<div align="justify">			<p>The following Csound orchestra and score can be used to find the impulse response and the frequency response of an LTI Csound opcode or section of code.</p>		</div>		<p><img src="Image166.gif" width="336" height="295"></p>		<p><b>Figure 20.26</b> Block diagram of <i>instr 2006</i>, an instrument designed to find the impulse and frequency response of a linear time-invariant opcode (<a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>reson</b></a>).</p>		<p>		<table cellspacing="0" border="0"  width="500">			<tr>				<td width="10%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="2"><a href="../../Book%20Instruments/20/2006/2006.html"><font face="Courier" size="2">2006</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; impulse response of reson filter</font></td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">idur1</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">7/sr</font></td>				<td width="52%" valign="top"><font face="Courier" size="2">; read the table once</font></td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">idur2</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1/sr</font></td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">ifreq</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">sr/8</font></td>				<td width="52%" valign="top"><font face="Courier" size="2">; read the table at 1 point per sample</font></td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">ifreq, idur1, ifreq, idur2, 0, 1, 0</font></td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1, a1, 1</font></td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">a3</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><font face="Courier" size="2">reson</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">a2, sr/10, sr/200</font></td>				<td width="52%" valign="top"><font face="Courier" size="2">; the system under test</font></td>			</tr>			<tr>				<td width="10%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a3</font></td>			</tr>			<tr>				<td width="10%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">display</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">a1, p3</font></td>				<td width="52%" valign="top"><font face="Courier" size="2">; display the impulse response</font></td>			</tr>			<tr>				<td width="10%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">dispfft</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">a3, p3, 4096, 0, 1</font></td>				<td width="52%" valign="top"><font face="Courier" size="2">; display the frequency response</font></td>			</tr>			<tr>				<td width="10%" valign="top">&nbsp;</td>				<td valign="top" colspan="6"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="7"><font face="Courier" size="2">; create a table with an impulse in the second position</font></td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">0</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">8</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">2</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">0 1 0 0 0 0 0 0</font></td>			</tr>			<tr>				<td valign="top" colspan="7">&nbsp;</td>			</tr>			<tr>				<td width="10%" valign="top"><font face="Courier" size="2">i 2006</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">0.185759637</font></td>				<td width="52%" valign="top"><font face="Courier" size="2">; create 2^14 (8192) samples</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.27</b> Orchestra and score code for <i>instr 2006</i>, an instrument which generates an impulse response of a <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>reson</b></a> filter.</p>		<div align="justify">			<p>The opcode <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><b>convolve</b></a> and its analysis utility companion, <a href="../../../2%20CD1/Reference/Manual4.0/utility/cvanal.htm"><b>cvanal</b></a>, implement frequency-domain convolution. The <a href="../../../2%20CD1/Reference/Manual4.0/utility/cvanal.htm"><b>cvanal</b></a> utility takes the Fast Fourier Transform of a soundfile, creating a frequency-response function (the soundfile is assumed to be the impulse response of some system or filter). The <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><b>convolve</b></a> opcode takes the frequency-response function, multiplies it by the Fourier Transform of the input signal and takes the Inverse Fourier Transform.</p>			<p>The following Csound code is designed to do that comparison. Note: because Csound&#146;s analysis files are machine specific (you cannot use PC analysis files on a Mac or vice versa) the impulse responses on the accompanying CD-ROM must be pre-analyzed by the Csound <a href="../../../2%20CD1/Reference/Manual4.0/utility/cvanal.htm"><b>cvanal</b></a> utility before they can be used for convolution.</p>		</div>		<p><img src="Image167.gif" width="529" height="432"></p>		<p><b>Figure 20.28</b> Block diagram of <i>instr 2007</i>, an instrument designed to do a comparison test and measure the impulse and direct implementation frequency response of an LTI opcode and the convolution method as shown in figure 20.29.</p>		<p><img src="Image168.gif" width="526" height="472"></p>		<p><b>Figure 20.29</b> Block diagram of <i>instr 2008</i>, an instrument designed to compare the impulse and frequency response of the convolution opcode with the direct method shown in figure 20.28.</p>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="3"><a href="../../Book%20Instruments/20/2007/2007.html"><font face="Courier" size="2">2007</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; Direct implementation test</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">iharm</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">int(44100/(p4)/2)-1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; avoid problems with delays</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">abuzz</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">0,0.45*p3,0,0.1*p3,10000,0.44*p3,10000,0.01*p3,0,1,0</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">aran</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">0, 0.01*p3, 10000, 0.44*p3, 10000, 0.1*p3, 0, 1, 0</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/buzz.htm"><font face="Courier" size="2">buzz</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">abuzz, p4, iharm, 1, -1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a3</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/x.htm"><font face="Courier" size="2">trirand</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a4</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">a2+a3*aran</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a5</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><font face="Courier" size="2">reson</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a4, sr/100, sr/5000</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; Same as test impulse</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a6</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/rms.htm"><font face="Courier" size="2">balance</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">a5, abuzz+aran</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">a6</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">display</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a6, p3/5</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; display impulse response</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">dispfft</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a6, p3/5, 4096, 0, 1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; display frequency response</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="8"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="9">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">2008</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; Convolution test</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">iharm</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">int(44100/(p4)/2)-1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">abuzz</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">0,0.45*p3,0,0.1*p3,10000,0.44*p3,10000,0.01*p3,0,1,0</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">aran</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">0, 0.01*p3, 10000, 0.44*p3, 10000, 0.1*p3, 0, 1, 0</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">ahalt</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">0, 8192/44100, 0, 0.001, 1, p3, 1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/buzz.htm"><font face="Courier" size="2">buzz</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">abuzz, p4, iharm, 1, -1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a3</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/x.htm"><font face="Courier" size="2">trirand</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a4</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">(a2+a3*aran)/1.1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a5</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><font face="Courier" size="2">convolve</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a4, &quot;reson_100_5000.con&quot;</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; Use cvanal to make</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">adely</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/delayr.htm"><font face="Courier" size="2">delay</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">abuzz+aran, 8192/sr</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a6</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/rms.htm"><font face="Courier" size="2">balance</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">a5, adely</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">a6</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">display</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a6, p3/5</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; display impulse response</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">dispfft</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a6, p3/5, 4096, 0, 1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; display frequency response</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="8"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="9">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td width="9%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">16384</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; sine table</font></td>			</tr>			<tr>				<td valign="top" colspan="9">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2007</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">110.25</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2008</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">6</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">110.25</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.30</b> Orchestra code for <i>instr 2007 </i>and <i>2008</i>, a direct implementation of an instrument that generates an impulse and measures the time and frequency responses(20<i>07</i>) and a convolution instrument for comparison(20<i>08</i>).</p>		<div align="justify">			<p>Csound has some other facilities for performing frequency-domain convolution but they are somewhat hidden. The interested reader is directed to <a href="../../../2%20CD1/Reference/Manual4.0/siggen/adsyn.htm"><b>pvoc</b></a> and <a href="../../../2%20CD1/Reference/Manual4.0/utility/pvanal.htm"><b>pvanal</b></a>, as well as the <a href="../../../2%20CD1/Reference/Manual4.0/spectral/top.htm"><b>spectral data types</b></a>.</p>		</div>		<p><b>Difference Equations</b></p>		<div align="justify">			<p>For continuous-time signals and systems, the behavior of the systems is often based on linear constant-coefficient <i>differential</i> equations. For discrete-time signals and systems, systems are often described by constant coefficient <i>difference</i> equations. The general form of a constant-coefficient difference equation is:</p>		</div>		<p><img src="Image169.gif" width="120" height="31">(20.41)</p>		<div align="justify">			<p>If one assumes that the system is initially at rest, one can calculate the frequency response and the impulse response from the difference equation in the following way: The discrete-time Fourier Transform of the difference equation is:</p>		</div>		<p><img src="Image170.gif" width="147" height="31"> (20.42)</p>		<div align="justify">			<p>which can be rearranged to:</p>		</div>		<p><img src="Image171.gif" width="119" height="61">(20.43)</p>		<div align="justify">			<p>The impulse response is then found from the inverse Fourier transform of <img src="Image172.gif" width="25" height="15">.</p>		</div>		<div align="justify">			<p>The difference equations are often represented by <i>block diagrams</i> in the following form:</p>		</div>		<p><img src="Image173.gif" width="207" height="119"></p>		<p><b>Figure 20.31 </b>Typical figures and form of block diagrams used to represent difference equations.</p>		<div align="justify">			<p>A circle with a plus sign is a summation operator. The box with the <i>D</i> in it is a delay operator. It corresponds to shifting the index from <i>n</i> to <i>n </i>- 1. The coefficient by the arrow corresponds to multiplication by the coefficient.</p>			<p>We can rewrite Equation(20.41) as a block diagram:</p>		</div>		<p><img src="Image174.gif" width="227" height="205"></p>		<p><b>Figure 20.32</b> The block diagram of equation 20.41.</p>		<div align="justify">			<p>The coefficients by the arrows correspond to multiplication by the coefficients in the previous equation.</p>		</div>		<div align="justify">			<p>If all of the <img src="Image175.gif" width="11" height="13"> are zero, except for <img src="Image176.gif" width="11" height="13">, then the output only depends on the present and past inputs and not on the past outputs. The impulse response of such a system returns to zero after the impulse has passed through the <i>M</i>th input. Such a system is said to have a <i>finite impulse response</i>, because the impulse response has a finite duration and the system is known as an <i>FIR</i> system. If any of the <img src="Image177.gif" width="11" height="13"> are not zero, then, in general, the impulse response never truly returns to zero, although it may get very small. These systems have feedback because the present value of the output depends on all of the previous ones. Such a system is said to have an <i>infinite impulse response</i> and is known as an <i>IIR</i> or <i>recursive</i> system (because of the feedback).</p>		</div>		<div align="justify">			<p>A system is said to be <i>stable</i> if a finite or bounded input produces a finite or bounded output. One can determine the stability of a system by examining the roots of the equation obtained, by replacing the factors of <img src="Image178.gif" width="23" height="12"> with <img src="Image179.gif" width="14" height="12">, <i>e.g.</i> <img src="Image180.gif" width="53" height="12">, setting the denominator of the transfer function to zero and solving for <img src="Image181.gif" width="8" height="8">. If the magnitudes or absolute values of all of the roots are less than 1, the system is stable. If the magnitude of any of the roots is greater than 1 the system is unstable. As an example, take the system with the transfer function:</p>		</div>		<p><img src="Image182.gif" width="112" height="25">(20.44)</p>		<div align="justify">			<p>First, replace the factors of <img src="Image178.gif" width="23" height="12"> with <img src="Image179.gif" width="14" height="12">.</p>		</div>		<p><img src="Image183.gif" width="91" height="25">(20.45)</p>		<div align="justify">			<p>Then, set the denominator equal to zero.</p>		</div>		<p><img src="Image184.gif" width="74" height="13">(20.46)</p>		<div align="justify">			<p>Solve the equation for <i>z</i>.</p>		</div>		<p><img src="Image185.gif" width="112" height="26">(20.47)</p>		<div align="justify">			<p>Check the magnitudes.</p>		</div>		<p><img src="Image186.gif" width="51" height="16">(20.48)</p>		<div align="justify">			<p>Since at least one (in this case both) of the roots has a magnitude greater than 1, the system is unstable.</p>		</div>		<div align="justify">			<p>The transfer function of an FIR system has no denominator and so it is always stable. In Csound, an unstable system usually shows up as having infinity (INF) appear as the magnitude of the largest sample.</p>		</div>		<p><b>Filters</b></p>		<div align="justify">			<p>A <i>filter</i> is a system with a specified or pre-determined frequency response. The usual purposes of a filter are either to remove undesired frequencies or emphasize desired ones. The four classic types of filters are <i>lowpass</i>, <i>highpass</i>, <i>bandpass</i> and <i>bandreject</i> or <i>notch</i>. For musical purposes one usually includes parametric equalization filters, shelving filters, comb filters and allpass filters. Filters can be divided up into FIR or IIR filters. For a given response, IIR filters require fewer elements or operations but cause non-linear phase shifts. FIR filters require many more elements but can be specified with linear phase shifts.</p>		</div>		<p><img src="Image187.gif" width="306" height="226"></p>		<p><b>Figure 20.33</b> Ideal versions of the four &quot;classic&quot; filters.</p>		<div align="justify">			<p>Csound has several built-in filters. The <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>tone</b></a>, <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>atone</b></a>, <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>reson</b></a> and <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>areson</b></a> opcodes are all IIR filters. The <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/butterhp.htm"><b>butterlp</b></a>, <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/butterhp.htm"><b>butterhp</b></a>, <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/butterhp.htm"><b>butterbp</b></a> and <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/butterhp.htm"><b>butterbr</b></a> are second-order IIR filters. Both sets implement the four classic filter types. The <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/lpread.htm"><b>lpread</b>/<b>lpreson</b> (<b>lpfreson</b>)</a> opcodes implement very-high order (up to 40 or 50) IIR filters from predefined tables of filter coefficients. The <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/comb.htm"><b>comb</b></a> and <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/comb.htm"><b>alpass</b></a> opcodes implement comb and allpass filters.</p>			<p>The impulse and frequency responses for <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>tone</b></a> are shown below. As shown above, the impulse responses can be used with <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><b>convolve</b></a> to compare direct implementation with convolution.</p>		</div>		<p><img src="Image188.gif" width="342" height="252"></p>		<p><b>Figure 20.34</b> Impulse response for <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>tone</b></a> ((KHP=fs/100). An impulse response plots the amplitude (or intensity) of the output from a filter when the input is an impulse. In this case, the output decays exponentially with time.</p>		<div align="justify">			<p>Csound also provides some tools for generating filters from scratch. Discrete-time filters are usually constructed from difference equations as discussed above. However, the most difficult task in constructing a filter is determining the coefficients in the difference equation. The task is similar to fitting a polynomial to an arbitrary function. Csound has no built-in facilities for calculating the coefficients. You have to do that yourself. (I will give you some hints on how, after we finish discussing how to implement a filter in Csound). However, once the coefficients are calculated, Csound does provide facilities for implementing the filter.</p>		</div>		<p><img src="Image189.gif" width="342" height="252"></p>		<p><b>Figure 20.35</b> Frequency response for <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><b>tone</b></a> (khp=f/100). A frequency response plot shows how a given system or filter amplifies or attenuates a signal as you change its frequency. It also shows how the signal&#146;s phase would change as you change its frequency. In this case, the gain is constant up to about 441 Hz. Above 441 Hz the gain drops with frequency. The phase shift is almost 0&deg; at low frequency and drops to &#151;180&deg; at 1/2 of the sampling rate.</p>		<div align="justify">			<p>The <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/delayr.htm"><b>delay1</b></a> opcode in Csound is the same as the <i>D</i> operator in the block diagrams shown in figures 20.31 and 20.32 and is useful for creating FIR filters. Filters longer than about 20 delays are unwieldy and are better implemented with <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><b>convolve</b></a>. The following example demonstrates implementing an FIR filter from scratch.</p>		</div>		<p><b>FIR Example</b></p>		<div align="justify">			<p>The difference equation:</p>		</div>		<p><img src="Image190.gif" width="154" height="24"> (20.49)</p>		<div align="justify">			<p>is an FIR system and has the frequency response:</p>		</div>		<p><img src="Image191.gif" width="249" height="27"> 20.50)</p>		<div align="justify">			<p>which is basically a linear-phase lowpass filter. A Csound instrument to implement and test this filter is:</p>		</div>		<p><img src="Image192.gif" width="350" height="448"></p>		<p><b>Figure 20.36</b> Block diagram of <i>instr 2009</i>, an instrument that implements and tests the FIR filter defined in equation 23.49.</p>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">kr</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">44100</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; avoid assorted problems</font></td>			</tr>			<tr>				<td valign="top" colspan="10">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="3"><a href="../../Book%20Instruments/20/2009/2009.html"><font face="Courier" size="2">2009</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; FIR Filter Example</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">sr/8, 7/sr, sr/8, 1/sr, 0, 1, 0</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a><font face="Courier" size="2"> </font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1, a1, 1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; Generate an impulse</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a3</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/delayr.htm"><font face="Courier" size="2">delay1</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a2</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; Filter delay 1</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a4</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/delayr.htm"><font face="Courier" size="2">delay1</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a3</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; Filter delay 2</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a5</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">0.25*a2+0.5*a3+0.25*a4</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; Summation</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">a5</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">display</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a5, p3</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; display impulse response</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">dispfft</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a5, p3, 4096, 0, 1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; display frequency response</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="9"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="10"><font face="Courier" size="2">; create a table with an impulse in the second position</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">8</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">2</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">0 1 0 0 0 0 0 0</font></td>			</tr>			<tr>				<td valign="top" colspan="10">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2009</font></td>				<td width="4%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">0.185759637</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">; create 2^14 (8192) samples (a nice FFT #)</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.37</b> Orchestra and score code for <i>instr 2009</i>, a simple lowpass design implemented by delaying, scaling and summing the input signal with the scaled delayed copies of the original.</p>		<p><b>IIR Example</b></p>		<div align="justify">			<p>The difference equation:</p>		</div>		<p><img src="Image193.gif" width="145" height="24"> (20.51)</p>		<div align="justify">			<p>which can be rewritten as:</p>		</div>		<p><img src="Image194.gif" width="145" height="24"> (20.52)</p>		<div align="justify">			<p>is an IIR system and has the frequency response:</p>		</div>		<p><img src="Image195.gif" width="121" height="36">(20.53)</p>		<div align="justify">			<p>which is sort of a bandpass-highpass response. A Csound instrument to implement and test this filter (thanks to Russell Pinkston) is:</p>		</div>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="2"><a href="../../Book%20Instruments/20/2010/2010.html"><font face="Courier" size="2">2010</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; IIR Filter Example</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">linseg</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">sr/8, 7/sr, sr/8, 1/sr, 0, 1, 0</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">1, a1, 1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; Generate impulse</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">aprev1</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/assign.htm"><font face="Courier" size="2">init</font></a><font face="Courier" size="2"> </font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">0</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; init y(n-1) to 0</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">aprev2</font></td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/assign.htm"><font face="Courier" size="2">init</font></a><font face="Courier" size="2"> </font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">0</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; init y(n-2) to 0</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">ainput</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a2</font></td>			</tr>			<tr>				<td valign="top" colspan="10"><font face="Courier" size="2">; y(n) = a0x(n)-b1y(n-1)-b2y(n-2)</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">aoutput</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1*ainput-0.5*aprev1-0.5*aprev2</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">aprev2</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">aprev1</font></td>			</tr>			<tr>				<td valign="top" colspan="2"><font face="Courier" size="2">aprev1</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">aoutput</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">aoutput</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">display</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">aoutput, p3</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; display impulse response</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="4"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/print.htm"><font face="Courier" size="2">dispfft</font></a></td>				<td valign="top" colspan="3"><font face="Courier" size="2">aoutput, p3, 4096, 0, 1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; frequency response</font></td>			</tr>			<tr>				<td valign="top" colspan="2">&nbsp;</td>				<td valign="top" colspan="8"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="10">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="10"><font face="Courier" size="2">; create a table with an impulse in the second position</font></td>			</tr>			<tr>				<td width="8%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">8</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">2</font></td>				<td valign="top" colspan="3"><font face="Courier" size="2">0 1 0 0 0 0 0 0</font></td>			</tr>			<tr>				<td valign="top" colspan="10">&nbsp;</td>			</tr>			<tr>				<td valign="top" colspan="3"><font face="Courier" size="2">i 2010</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="5"><font face="Courier" size="2">0.185759637</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; create 2^14 (8192) samples</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.38</b> Orchestra and score code for <i>instr 2010</i>, an IIR bandpass filter based on equation 20.52.</p>		<div align="justify">			<p>Always check a IIR filter built from scratch, for stability. It is very easy to make an unstable IIR filter. In using filters in musical applications, it is common to change the filter parameters, such as the cutoff frequency or the bandwidth during a note. Strictly speaking, if you change the parameters with time, the filter is no longer time-invariant and the analysis techniques we have discussed no longer apply. However, if the changes are slow compared with the fundamental frequency of the note, approximating the filter as an LTI system is usually adequate.</p>		</div>		<p><b>Filter Design</b></p>		<div align="justify">			<p>Designing an IIR filter to meet specified performance characteristics is a little beyond what we can do in one chapter. The interested reader is directed to the references. Designing an FIR filter can also be quite involved. However there is one relatively straightforward method which uses the techniques we have discussed up to this point.</p>		</div>		<div align="justify">			<p>The first step is to plot or sketch the magnitude of the desired frequency response. As mentioned under the heading The Fourier Transform above. The discrete-time frequency response must be a periodic function, so we have to sketch or plot one full period of the function. A plot of one period of an ideal lowpass filter with a cutoff frequency of 1/8 (Remember the useful range of <i>F</i> is from 0 to 1/2) is given below.</p>		</div>		<p><img src="Image196.gif" width="342" height="216"></p>		<p><b>Figure 20.39</b> Plot of one period of an ideal lowpass filter with a cutoff frequency of 1/8.</p>		<div align="justify">			<p>The next step is to decide how many points to include in the filter. It should be an odd number. The larger the number the better the filter, but the more work you will have to do. Next, for calculation purposes you need to find the index range. For example, for a 5-point filter, the index range is from -2 to 2. For a 15-point filter the index range is from -7 to 7. Call the ending index <i>N</i>.</p>		</div>		<div align="justify">			<p>With the index range in hand you need to calculate the Inverse Fourier Transform for the points in the index range using the equation above. The result will be a set of raw filter coefficients, <img src="Image197.gif" width="19" height="14">. Because our filter uses only a finite number of points we will have to smooth the coefficients. We will do this using a <i>window</i>. Every DSP specialist has his or her own favorite window. We will use the <i>Hamming</i> window:</p>		</div>		<p><img src="Image198.gif" width="106" height="24">(20.54)</p>		<div align="justify">			<p>where <i>n</i> is the coefficient index and <i>N</i> is the ending index. The final filter coefficients, <img src="Image199.gif" width="19" height="14">, are found by multiplying the raw coefficients by the window coefficients:</p>		</div>		<p><img src="Image200.gif" width="69" height="14">(20.55)</p>		<div align="justify">			<p>For short filters, the coefficients can be used as explained above. For longer filters, the coefficients should be put into a soundfile as sound samples (using something other than Csound), then <a href="../../../2%20CD1/Reference/Manual4.0/utility/cvanal.htm"><b>cvanal</b></a> should be used to convert the response to a frequency response and <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><b>convolve</b></a> should be used to implement the filter.</p>			<p>It is usually wise to check how close the actual filter came to the desired filter. You do so by taking the Fourier Transform of the filter coefficients with the equation above. However, the summation only runs from &#151;<i>N</i> to <i>N</i> instead of -&deg; to &deg;. The results for a 41-point filter (<i>N</i>=20) are shown below:</p>		</div>		<p><img src="Image201.gif" width="342" height="216"></p>		<p><b>Figure 20.40</b> The plot for a 41-point filter with a cutoff frequency of 1/8 as calculated by <i>Mathematica</i> using the commands below.</p>		<div align="justify">			<p><i>Mathematica</i> can handle most of the calculation work for you. The following <i>Mathematica</i> commands will calculate and plot the results for a 41-point filter with a cutoff frequency of 1/8.</p>		</div>		<p>&lt;&lt;Calculus`FourierTransform`</p>		<p>XofF=1-UnitStep[F-1/8]+UnitStep[F-7/8]</p>		<p>Plot[XofF,{F,0,1},AxesLabel-&gt;{F,mag}]</p>		<p>xofn=Integrate[XofF Exp[2 Pi I F n],{F,0,1}</p>		<p>Nmax=20</p>		<p>RawFilter=Table[Limit[xofn,n-&gt;z],{z,-Nmax,Nmax}]</p>		<p>Window=Table[0.54+0.46Cos[n Pi/Nmax],{n,-Nmax,Nmax}]</p>		<p>Filter=Window RawFilter</p>		<p>ListPlot[RawFilter,Prolog-&gt;PointSize[0.02],PlotRange-&gt;All]</p>		<p>ListPlot[Filter,Prolog-&gt;PointSize[0.02],PlotRange-&gt;All]</p>		<p>InverseTable=Table[Exp[-2 Pi I n F],{n,-Nmax,Nmax}]</p>		<p>NewXofF=Apply[Plus,(Filter InverseTable)]</p>		<p>Plot[Abs[NewXofF],{F,0,1},AxesLabel-&gt;{F,mag}]</p>		<div align="justify">			<p>The only reason for the &lt;&lt;Calculus`FourierTransform` line is for the UnitStep function. <i>Nmax</i> can be changed to create larger or smaller filters.</p>			<p>You have probably guessed by now that the impulse response of an FIR filter contains the filter coefficients in sequence. In other words, the filter coefficient <img src="Image202.gif" width="19" height="14"> equals the impulse response, <img src="Image203.gif" width="19" height="14">. This idea is the guiding principal behind <a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><b>convolve</b></a>. Since any soundfile <i>could</i> be the impulse response of <i>some</i> filter we can assume that it is and use the soundfile as an FIR filter. The result of using the opening bars of Beethoven&#146;s<i> </i>&quot;Ninth Symphony&quot; to filter &quot;Wild Thing&quot; will probably not be what you would expect, but it can be done.</p>		</div>		<p><b>Modulation</b></p>		<div align="justify">			<p>Modulation is the use of one signal to change the properties of another signal. Modulation is not a time-invariant process, but the methods we have developed to this point can provide a surprising amount of insight into modulation.</p>		</div>		<p><b>Frequency Modulation</b></p>		<div align="justify">			<p>The most common form of modulation in digital music production is <i>frequency modulation</i>, or FM. A thorough understanding of FM is way beyond the scope of this chapter, but a brief example will be given. In modulation, one signal is normally called the carrier signal, <img src="Image204.gif" width="17" height="15"> and the other is called the modulating signal, <img src="Image205.gif" width="24" height="15">. In FM the modulating signal changes the frequency of the carrier. For example:</p>		</div>		<div align="justify">			<p>&nbsp;</p>		</div>		<p><img src="Image206.gif" width="130" height="16">(20.56)</p>		<div align="justify">			<p>&nbsp;</p>		</div>		<div align="justify">			<p>where <img src="Image207.gif" width="76" height="15"> and <img src="Image208.gif" width="13" height="13"> is the modulation index. For communications systems, <img src="Image205.gif" width="24" height="15"> is usually band-limited, <img src="Image209.gif" width="10" height="13"> is usually much higher than any frequency component in <img src="Image205.gif" width="24" height="15"> and <img src="Image208.gif" width="13" height="13"> is fairly small. For musical applications, <img src="Image209.gif" width="10" height="13"> is usually comparable to the frequency components in <img src="Image205.gif" width="24" height="15"> and <img src="Image208.gif" width="13" height="13"> is rather large. One less common use for FM is to create alien voices for science-fiction movies. The following example demonstrates modulating a sine wave with a spoken voice. The sound file <i>Hamlet.aif</i> is on the accompanying CD-ROM but any recording of a spoken voice may be used (my thanks to the renowned BBC star and Harvey Mudd professor, Tony Bright, for his Shakespearean recitation).</p>		</div>		<p><img src="Image210.gif" width="222" height="267"></p>		<p><b>Figure 20.41</b> Block diagram of <i>instr 2011</i>, an instrument which frequency modulates a soundfile of a sine wave with a male speaking voice.</p>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="3"><a href="../../Book%20Instruments/20/2011/2011.html"><font face="Courier" size="2">2011</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; FM Sci-fi Voice example</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">soundin</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">&quot;Hamlet.aif&quot;</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a3</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">line</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">0, p3, 0.4 </font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; modulation index</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">10000, 256-a3*a1, 1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; modulate</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="3"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">a2</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="8"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="9">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">4096</font></td>				<td width="8%" valign="top"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">1</font></td>				<td width="42%" valign="top"><font face="Courier" size="2">; sine table</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2011</font></td>				<td width="6%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="7"><font face="Courier" size="2">22</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.42</b> Orchestra and score code for <i>instr 2011</i>, an FM instrument with a sinusoidal carrier and a <a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><b>soundin</b></a> modulator.</p>		<div align="justify">			<p>A thorough exploration of FM requires Bessel functions and other unpleasantries that we will forego at this point.</p>		</div>		<p><b>Amplitude Modulation</b></p>		<div align="justify">			<p>A less common form of modulation in music production, but still valuable and much more amenable to analysis is <i>amplitude modulation</i> or <i>AM</i>. In AM the carrier is multiplied by the modulating signal.</p>		</div>		<p><img src="Image211.gif" width="78" height="15">(20.57)</p>		<div align="justify">			<p>There is usually a symmetry between operations in the frequency domain and operations in the time domain. Since convolution in the time domain corresponds to multiplication in the frequency domain, it should come as no surprise that multiplication in the time domain corresponds to convolution in the frequency domain. The Fourier transform of <img src="Image212.gif" width="77" height="15"> is two impulses, one at <img src="Image213.gif" width="10" height="13"> and the other at <img src="Image214.gif" width="16" height="13">. If <img src="Image205.gif" width="24" height="15"> is band-limited, then the convolution of <img src="Image215.gif" width="21" height="15"> with <img src="Image216.gif" width="29" height="15"> generates two copies of <img src="Image216.gif" width="29" height="15">, one centered at <img src="Image213.gif" width="10" height="13"> and the other at <img src="Image214.gif" width="16" height="13">. The figure below illustrates the concept.</p>		</div>		<div align="justify">			<p>Implementing AM in Csound is surprisingly straightforward. One simply multiplies two audio-rate variables together. The example below illustrates creating sci-fi voices using AM. The resultant voice is much more intelligible than the FM version. The sound file <i>Hamlet.aif</i> is on the accompanying CD-ROM, but any recording of a spoken voice may be used.</p>		</div>		<p><img src="Image217.gif" width="237" height="233"></p>		<p><b>Figure 20.43</b> Block diagram of <i>instr 2012</i>, an instrument which amplitude modulates a soundfile of a male speaking voice with a sine wave.</p>		<p>		<table cellspacing="0" border="0"  width="477">			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="3"><a href="../../Book%20Instruments/20/2012/2012.html"><font face="Courier" size="2">2012</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; AM Sci-fi Voice example</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">afmod</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/line.htm"><font face="Courier" size="2">expseg</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">8000, p3, 40</font></td>				<td width="41%" valign="top"><font face="Courier" size="2">; Vary Carrier frequency</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">soundin</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">&quot;Hamlet.aif&quot;</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1, afmod, 1</font></td>				<td width="41%" valign="top"><font face="Courier" size="2">; Generate carrier</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a1*a2</font></td>				<td width="41%" valign="top"><font face="Courier" size="2">; modulate</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="7"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="8">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">4096</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">1</font></td>				<td width="41%" valign="top"><font face="Courier" size="2">; sine table</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2012</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="6"><font face="Courier" size="2">22</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.44</b> Orchestra and score code for <i>instr 2012</i>, an AM instrument with a <a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><b>soundin</b></a> modulator.</p>		<p><img src="Image218.gif" width="305" height="236"></p>		<p><b>Figure 20.45</b> Amplitude modulation.</p>		<p><b>Voice Scrambler-Descrambler</b></p>		<div align="justify">			<p>One final example makes use of most of the concepts we have covered in this chapter. A common use for DSP is a voice scrambler for the telephone. Most telephones are band-limited. This example uses a band limit of 8 kHz. If one amplitude modulates an 8 kHz carrier with a band-limited voice and then filters out all frequencies above 8 kHz and below -8 kHz, one ends up with a perfectly reversed voice spectrum. It is very hard to understand someone speaking upside down. The following Csound example performs the modulation and filtering. The soundfile <i>Sharp_8kHz_Lowpass.aif</i> must be processed with <a href="../../../2%20CD1/Reference/Manual4.0/utility/cvanal.htm"><b>cvanal</b></a> to generate <i>Sharp_8kHz_Lowpass.con</i> before the code can be run.</p>			<p><img src="Image219.gif" width="270" height="509"><br>			</p>		</div>		<p><b>Figure 20.46</b> Block diagram of <i>instr 2013</i>, an instrument which reverses the spectrum of a <a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><b>soundin</b></a> and thus creates a voice scrambler/descrambler.</p>		<p>		<table cellspacing="0" border="0"  width="477">			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="3"><a href="../../Book%20Instruments/20/2013/2013.html"><font face="Courier" size="2">2013</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; Phone Voice scrambler</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">acarr</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1, 8000, 1</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; gen carrier</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">amod</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">soundin</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">&quot;Hamlet.aif&quot;</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; The file to scramble.</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a1</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><font face="Courier" size="2">tone</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">amod, 10000</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; gentle prefilter</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a2</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><font face="Courier" size="2">convolve</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a1, &quot;Sharp_8kHz_Lowpass.con&quot;</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; Sharp Prefilter</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">asig</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a2*acarr</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; modulate</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a3</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><font face="Courier" size="2">tone</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">asig, 10000</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; gentle filter</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">ascram</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><font face="Courier" size="2">convolve</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a3, &quot;Sharp_8kHz_Lowpass.con&quot;</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; Sharp filter</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">ascram*0.2999</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="7"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="8">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">16384</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">1</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; sine table</font></td>			</tr>			<tr>				<td valign="top" colspan="8">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2013</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="6"><font face="Courier" size="2">24</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.47</b> Orchestra and source code for <i>instr 2013</i> which scrambles a <a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><b>soundin</b></a> using the convolve opcode.</p>		<div align="justify">			<p>To recover the original voice, one can modulate the new signal with an 8 kHz carrier and then filter out all frequencies above 8 kHz and below -8 kHz. This process reverses the spectrum once again, restoring it to its original state. One needs only to change the name of the input file and use the above <i>2013.orc</i> file to perform the descrambling as shown in <i>instr 2014 </i>below.</p>		</div>		<p>		<table cellspacing="0" border="0"  width="478">			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">instr</font></a></td>				<td valign="top" colspan="3"><a href="../../Book%20Instruments/20/2014/2014.html"><font face="Courier" size="2">2014</font></a></td>				<td valign="top" colspan="2"><font face="Courier" size="2">; Phone voice descrambler</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">acarr</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/siggen/oscil.htm"><font face="Courier" size="2">oscil</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">1, 8000, 1</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; gen carrier</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">amod</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">soundin</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">&quot;VoiceScrambler.aif&quot;</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; File to descramble</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">asig</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">=</font></td>				<td valign="top" colspan="4"><font face="Courier" size="2">amod*acarr</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; modulate</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">a3</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/port.htm"><font face="Courier" size="2">tone</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">asig, 10000</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; Gentle Filter</font></td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">adescr</font></td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigmod/convolve.htm"><font face="Courier" size="2">convolve</font></a></td>				<td valign="top" colspan="4"><font face="Courier" size="2">a3, &quot;Sharp_8kHz_Lowpass.con&quot;</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; Sharp Filter</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="2"><a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><font face="Courier" size="2">out</font></a></td>				<td valign="top" colspan="5"><font face="Courier" size="2">adescr*0.7246</font></td>			</tr>			<tr>				<td width="11%" valign="top">&nbsp;</td>				<td valign="top" colspan="7"><a href="../../../2%20CD1/Reference/Manual4.0/syntax/iblock.htm"><font face="Courier" size="2">endin</font></a></td>			</tr>			<tr>				<td valign="top" colspan="8">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">f 1</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">16384</font></td>				<td width="7%" valign="top"><font face="Courier" size="2">10</font></td>				<td valign="top" colspan="2"><font face="Courier" size="2">1</font></td>				<td width="31%" valign="top"><font face="Courier" size="2">; sine table</font></td>			</tr>			<tr>				<td valign="top" colspan="8">&nbsp;</td>			</tr>			<tr>				<td width="11%" valign="top"><font face="Courier" size="2">i 2014</font></td>				<td width="5%" valign="top"><font face="Courier" size="2">0</font></td>				<td valign="top" colspan="6"><font face="Courier" size="2">24</font></td>			</tr>		</table>		</p>		<p><b>Figure 20.48</b> Orchestra and source code for <i>instr 2014</i> which descrambles a previously scrambled <a href="../../../2%20CD1/Reference/Manual4.0/sigio/in.htm"><b>soundin</b></a> using the convolve opcode.</p>		<div align="justify">			<p>The difference is that the scrambling orchestra band-limits the input signal to 8 kHz before scrambling. Because the scrambled signal is already band-limited to 8 kHz, the prefiltering is not necessary for descrambling.</p>		</div>		<div align="justify">			<p>This example works well in Csound at the common sampling rate of 44.1 kHz but will not run properly at 22 kHz, because the modulation creates sound at frequencies up to 16 kHz before the lowpass filtering. At the lower sampling rate the portion of the scrambled spectrum from 11 to 16 kHz aliases back into the range of 11 to 6 kHz, so the lowpass filter cannot remove it. The voice would be well scrambled but impossible to unscramble.</p>		</div>		<p>&nbsp;</p>		<p><b>Figure 20.49</b> Block diagram of voice scrambler/descrambler</p>		<p><b>Conclusion</b></p>		<div align="justify">			<p>This chapter has only been able to scratch the surface of signal processing and Csound. However, I hope that I have convinced you, the reader, that Csound is a valuable, if not an optimal tool for exploring the concepts of digital signal processing and that signal-processing methods and techniques are valuable for understanding what Csound does and why.</p>		</div>		<p><img src="Image220.gif" width="342" height="252"></p>		<p><img src="Image221.gif" width="342" height="252"></p>		<p><img src="Image222.gif" width="342" height="252"></p>		<p><img src="Image223.gif" width="342" height="252"></p>		<p><img src="Image224.gif" width="342" height="252"></p>		<p><img src="Image225.gif" width="342" height="252"></p>		<p><img src="Image226.gif" width="342" height="252"></p>		<p><img src="Image227.gif" width="342" height="252"></p>		<p><img src="Image228.gif" width="342" height="252"></p>		<p><img src="Image229.gif" width="342" height="252"></p>		<p><img src="Image230.gif" width="342" height="252"></p>		<p><img src="Image231.gif" width="342" height="252"></p>		<p><img src="Image232.gif" width="342" height="252"></p>		<p><img src="Image233.gif" width="342" height="252"></p>		<p><img src="Image234.gif" width="342" height="252"></p>		<p><img src="Image235.gif" width="342" height="252"></p>		<p><img src="Image236.gif" width="342" height="252"></p>		<p><img src="Image237.gif" width="342" height="252"></p>		<p><img src="Image238.gif" width="342" height="252"></p>		<p><img src="Image239.gif" width="342" height="252"></p>		<p><b>Figure 20.50</b> Impulse and Frequency Response Graphs.</p>		<p><b>References</b></p>		<div align="justify">			<p>Chamberlin, H. 1980.<i> Musical Applications of Microprocessors</i>. Rochelle Park, N.J.: Hayden.</p>		</div>		<div align="justify">			<p>Hamming, R.W. 1983. <i>Digital Filters</i>. Englewood Cliffs, N.J.: Prentice-Hall.</p>		</div>		<div align="justify">			<p>Oppenheim, A.V., A.S. Willsky and I.T. Young. 1983. <i>Signals and Systems</i>. Englewood Cliffs, N.J.: Prentice-Hall.</div>	</body></html>